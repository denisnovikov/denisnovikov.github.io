<!DOCTYPE html><html lang="ru"><head>  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-89748707-1"></script> <script> window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'UA-89748707-1'); </script><base href="https://denisnovikov.github.io"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="google-site-verification" content="aiV-7fBXdNhcJILKp5GXFesXJetzCgLWAbif-tZKfrY" /><meta name="yandex-verification" content="41a2ad868168b23f" /><meta name="openstat-verification" content="62f671b1eaa0d2a7ce234219685a42b3d7770961" /><meta property="op:markup_version" content="v1.0"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="application-name" content="FrontEnd Blog"><meta name="format-detection" content="telephone=no"><meta name="generator" content="jekyll"><meta name="google" content="notranslate"><meta name="rating" content="General"><meta name="referrer" content="never"><meta name="robots" content="index,follow,noodp"><meta name="subject" content="blog"><meta name="url" content="https://denisnovikov.github.io"><meta name="viewport" content="width=device-width, initial-scale=1"><title> Как использовать arFilter, в Битрикс API - denisnovikov.github.io</title><meta name="description" content="Без лишних вступлений, перейдем к одному из очень важных понятий — фильтрация элементов в Битриксе."><link rel="alternate" hreflang="ru" href="/blog/how-to-use-arfilter-bitrix-api/" /><link rel="canonical" href="https://denisnovikov.github.io/blog/how-to-use-arfilter-bitrix-api/"><link rel="author" href="DNovikov"><link rel="me" href="https://github.com/denisnovikov" type="text/html"><link rel="me" href="mailto:dnovikov1808@gmail.com"><link href='https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|Roboto+Condensed:700&subset=latin' rel='stylesheet' type='text/css'><link rel="stylesheet" href="/assets/css/main.css"><meta property="og:url" content="https://denisnovikov.github.io/blog/how-to-use-arfilter-bitrix-api/"><meta property="og:type" content="website"><meta property="og:title" content="Как использовать arFilter, в Битрикс API"><meta property="og:description" content="Без лишних вступлений, перейдем к одному из очень важных понятий — фильтрация элементов в Битриксе"><meta property="og:site_name" content="denisnovikov.github.io"><meta property="og:locale" content="ru_RU"><meta property="article:author" content="DNovikov"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@dev_novikov"><meta name="twitter:creator" content="@dev_novikov"><meta name="twitter:url" content="https://denisnovikov.github.io/blog/how-to-use-arfilter-bitrix-api/"><meta name="twitter:title" content="Как использовать arFilter, в Битрикс API"><meta name="twitter:description" content="Без лишних вступлений, перейдем к одному из очень важных понятий — фильтрация элементов в Битриксе"><meta property="og:image" content="https://denisnovikov.github.io/assets/images/bg.svg"><meta name="twitter:image" content="https://denisnovikov.github.io/assets/images/bg.svg"><body><div id="shadow"></div><header class="main-header content-wrapper"> <input type="checkbox" id="menu-checkbox" /><nav class="center-wrapper nav-main"> <a class="blog-logo" href="/">denisnovikov.github.io</a> <a href="/about/">О проекте</a> <a href="/blog/">Все записи блога</a> <a href="/feed.xml" rel="alternate" type="application/rss+xml">RSS</a> <label for="menu-checkbox" class="toggle-button" data-open="☰" data-close="☰" onclick></label></nav></header><aside class="sidebar" role="note" style=" background-image: url( /assets/images/pages/bg.svg)"><div class="cover"><div class="cover-text"><div class="heading"> <a href="/blog/#bitrix">bitrix</a></div><p> Без лишних вступлений, перейдем к одному из очень важных понятий — фильтрация элементов в Битриксе Как использовать arFilter, в Битрикс API</div></div><div id="switcher"></div></aside><main class="content-wrapper"><article class="post"><h1 class="post-title">Как использовать arFilter, в Битрикс API</h1><p class="post-meta"> <time datetime="2015-10-24">24-10-2015</time> &nbsp;/&nbsp; <span>forwww.com</span><div class="post-content"><p>Без лишних вступлений, перейдем к одному из очень важных понятий — фильтрация элементов в Битриксе.<h2 id="Битрикс-arfilter">Битрикс arFilter</h2><p>Вы уже знаете <a href="http://forwww.com/bitrix-how-to-get-element-and-section-list/">как выводить элементы и разделы</a>. В документации 1С-Битрикс мы можем ясно видеть, что, не только приравнивание значений нам доступно но и:<ul><li>«!» — не равно<li>«&lt;» — меньше<li>«&lt;=» — меньше либо равно<li>«&gt;» — больше<li>«&gt;=» — больше либо равно<li>«&gt;&lt;» — между</ul><p>На моей практике использовать «между» мне не доводилось. А вот с остальным все гораздо проще, чем может показаться на первый взгляд. Вам важно уловить несколько очень важных вещей, которые сделают ваш код чуть лучше.<h2 id="Используя-arfilter-вы-избавите-себя-от-лишних-проверок">Используя arFilter вы избавите себя от лишних проверок</h2><p>И это действительно так. Предположим, что у нас уже есть свойство которое устанавливает, есть ли товар в наличии, и вам необходимо написать условие:<p><em>Если количество товара больше 0 или свойство Наличие = Да, то показываем товар</em><p>Так вот, если не знать про сложную логику фильтра (о которой я расскажу чуть ниже), то мы бы писали через старые добрые «<strong>if</strong>, <strong>else</strong>«, причем уже после получения параметров — но, этого можно избежать еще на этапе выборки данных.<h2 id="Если-использовать-в-скриптах-arfilter-и-arselect--вы-исключите-лишние-данные">Если использовать в скриптах arFilter и arSelect — вы исключите лишние данные</h2><p>На самом деле этот код:<figure class="highlight"><pre><code class="language-php" data-lang="php"><span class="nx">Array</span><span class="p">(</span><span class="s2">"ID"</span> <span class="o">=&gt;</span> <span class="s2">"ASC"</span><span class="p">,</span> <span class="s2">" ACTIVE"</span> <span class="o">=&gt;</span> <span class="s2">"Y"</span><span class="p">),</span><br data-jekyll-commonmark-ghpages="" /><span class="nx">Array</span><span class="p">(</span><br data-jekyll-commonmark-ghpages="" />    <span class="s2">"IBLOCK_ID"</span> <span class="o">=&gt;</span> <span class="mi">14</span><span class="p">,</span><br data-jekyll-commonmark-ghpages="" />    <span class="s1">'PROPERTY_SALELEADER_VALUE'</span> <span class="o">=&gt;</span> <span class="s1">'да'</span><br data-jekyll-commonmark-ghpages="" /><span class="p">),</span><br data-jekyll-commonmark-ghpages="" /><span class="kc">false</span><span class="p">,</span><br data-jekyll-commonmark-ghpages="" /><span class="kc">false</span><span class="p">,</span><br data-jekyll-commonmark-ghpages="" /><span class="nx">Array</span><span class="p">(</span><span class="s1">'ID'</span><span class="p">,</span> <span class="s1">'NAME'</span><span class="p">,</span> <span class="s1">'CODE'</span><span class="p">)</span></code></pre></figure><p>наглядно показывает, что ничего лишнего мы не будем передавать (важно не только указывать условия в фильтре, но и только те поля которые вы будете использовать, arSelect, или в данном случае последний массив). Записывать «больше-меньше» нужно таким вот образом:<figure class="highlight"><pre><code class="language-php" data-lang="php"><span class="s1">'&gt;=CATALOG_PRICE_1'</span> <span class="o">=&gt;</span> <span class="s1">'250'</span><span class="p">,</span></code></pre></figure><p>Для остальных условий — аналогично, пишем перед свойством <strong>&gt;</strong>, <strong>&lt;</strong>, <strong>&gt;=</strong>, <strong>&lt;=</strong>, <strong>!</strong> и вуаля.<h2 id="Как-написать-фильтр-со-сложной-логикой-1С-Битрикс">Как написать фильтр со сложной логикой 1С-Битрикс</h2><p>Вот мы и подошли к самому интересному и не очевидному. Сложный фильтр может принимать 2 значения <strong>AND</strong> и <strong>OR</strong> (И и ИЛИ). При этом сложность условия, опять же, ограничивается лишь вашей фантазией. Не будем ходить далеко, возьмем пример из документации:<figure class="highlight"><pre><code class="language-php" data-lang="php"><span class="nv">$arFilter</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><br data-jekyll-commonmark-ghpages="" />    <span class="s2">"IBLOCK_ID"</span> <span class="o">=&gt;</span> <span class="nv">$IBLOCK_ID</span><span class="p">,</span><br data-jekyll-commonmark-ghpages="" />    <span class="s2">"SECTION_CODE"</span> <span class="o">=&gt;</span> <span class="s2">"orange"</span><span class="p">,</span><br data-jekyll-commonmark-ghpages="" />    <span class="s2">"INCLUDE_SUBSECTIONS"</span> <span class="o">=&gt;</span> <span class="s2">"Y"</span><span class="p">,</span><br data-jekyll-commonmark-ghpages="" />    <span class="k">array</span><span class="p">(</span><br data-jekyll-commonmark-ghpages="" />        <span class="s2">"LOGIC"</span> <span class="o">=&gt;</span> <span class="s2">"OR"</span><span class="p">,</span><br data-jekyll-commonmark-ghpages="" />        <span class="k">array</span><span class="p">(</span><span class="s2">"&lt;PROPERTY_RADIUS"</span> <span class="o">=&gt;</span> <span class="mi">50</span><span class="p">,</span> <span class="s2">"=PROPERTY_CONDITION"</span> <span class="o">=&gt;</span> <span class="s2">"Y"</span><span class="p">),</span><br data-jekyll-commonmark-ghpages="" />        <span class="k">array</span><span class="p">(</span><span class="s2">"&gt;=PROPERTY_RADIUS"</span> <span class="o">=&gt;</span> <span class="mi">50</span><span class="p">,</span> <span class="s2">"!=PROPERTY_CONDITION"</span> <span class="o">=&gt;</span> <span class="s2">"Y"</span><span class="p">),</span><br data-jekyll-commonmark-ghpages="" />    <span class="p">),</span><br data-jekyll-commonmark-ghpages="" /><span class="p">);</span></code></pre></figure><p>Итак, для сложного фильтра, нам нужно создать массив, указать значение <strong>LOGIC</strong> в значение OR или AND, и после запятой создать 2 сравниваемых массива. Как видите, тут есть практически все условия о которых мы говорили выше (меньше, равно, больше или равно, не равно).<h2 id="Битрикс-arfilter--как-использовать-подзапросы">Битрикс $arFilter — как использовать подзапросы</h2><p>Ситуация следующая — у нас есть каталог с оптовыми ценами, и есть товары с торговыми предложениями. Используем подзапросы при помощи <strong>CIBlockElement::SubQuery</strong>:<figure class="highlight"><pre><code class="language-php" data-lang="php"><span class="nv">$arSubQuery</span> <span class="o">=</span> <span class="nx">Array</span><span class="p">(</span><span class="s1">'IBLOCK_ID'</span> <span class="o">=&gt;</span> <span class="mi">33</span><span class="p">,</span> <span class="s1">'&gt;CATALOG_PRICE_3'</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">);</span><br data-jekyll-commonmark-ghpages="" /><br data-jekyll-commonmark-ghpages="" /><span class="nv">$arSort</span> <span class="o">=</span> <span class="nx">Array</span><span class="p">(</span><span class="s1">'SHOW_COUNTER'</span> <span class="o">=&gt;</span> <span class="s1">'DESC'</span><span class="p">);</span><br data-jekyll-commonmark-ghpages="" /><span class="nv">$arFilter</span> <span class="o">=</span> <span class="nx">Array</span><span class="p">(</span><br data-jekyll-commonmark-ghpages="" />	<span class="s1">'SECTION_ID'</span> <span class="o">=&gt;</span> <span class="nv">$arResult</span><span class="p">[</span><span class="s1">'ID'</span><span class="p">],</span><br data-jekyll-commonmark-ghpages="" />	<span class="s1">'INCLUDE_SUBSECTIONS'</span> <span class="o">=&gt;</span> <span class="s1">'Y'</span><span class="p">,</span><br data-jekyll-commonmark-ghpages="" />	<span class="s1">'PROPERTY_SALELEADER_VALUE'</span> <span class="o">=&gt;</span> <span class="s1">'да'</span><span class="p">,</span><br data-jekyll-commonmark-ghpages="" />	<span class="s1">'ACTIVE'</span> <span class="o">=&gt;</span> <span class="s1">'Y'</span><span class="p">,</span><br data-jekyll-commonmark-ghpages="" />	<span class="k">array</span><span class="p">(</span><br data-jekyll-commonmark-ghpages="" />		<span class="s2">"LOGIC"</span> <span class="o">=&gt;</span> <span class="s2">"OR"</span><span class="p">,</span><br data-jekyll-commonmark-ghpages="" />		<span class="k">array</span><span class="p">(</span><span class="s1">'&gt;CATALOG_QUANTITY'</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">),</span><br data-jekyll-commonmark-ghpages="" />		<span class="k">array</span><span class="p">(</span><span class="s1">'PROPERTY_PRODAZA_VALUE'</span> <span class="o">=&gt;</span> <span class="s1">'Да'</span><span class="p">),</span><br data-jekyll-commonmark-ghpages="" />	<span class="p">),</span><br data-jekyll-commonmark-ghpages="" />	<span class="k">array</span> <span class="p">(</span><br data-jekyll-commonmark-ghpages="" />		<span class="s2">"LOGIC"</span> <span class="o">=&gt;</span> <span class="s2">"OR"</span><span class="p">,</span><br data-jekyll-commonmark-ghpages="" />		<span class="k">array</span><span class="p">(</span><span class="s1">'&gt;CATALOG_PRICE_3'</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">'IBLOCK_ID'</span> <span class="o">=&gt;</span> <span class="mi">6</span><span class="p">),</span><br data-jekyll-commonmark-ghpages="" />		<span class="k">array</span><span class="p">(</span><span class="s1">'ID'</span> <span class="o">=&gt;</span> <span class="nx">CIBlockElement</span><span class="o">::</span><span class="na">SubQuery</span><span class="p">(</span><span class="s1">'PROPERTY_CML2_LINK'</span><span class="p">,</span> <span class="nv">$arSubQuery</span><span class="p">)),</span><br data-jekyll-commonmark-ghpages="" />	<span class="p">)</span><br data-jekyll-commonmark-ghpages="" /><span class="p">);</span></code></pre></figure><p>Первый «сложный» фильтр проверяет есть ли товар в наличии, а второй — выбирает только те товары, у которых оптовая цена (‘CATALOG_PRICE_3’) больше 0.<p>Надеюсь вам стало более понятно как работает $arFilter и что с ним можно делать.<p align="right"><small><em>Источник: http://forwww.com/how-to-use-filter-in-bitrix/</em></small><div class="post-links"> <a class="link-to-post" href="/blog/measure-performance-of-code-blocks/"> <span class="link-to-post__next">&#10535; &nbsp;Next post</span> <span class="link-to-post__title">Измерение производительности блоков кода</span> </a> <a class="link-to-post" href="/blog/how-to-create-a-template-for-a-site-on-1c-bitrix/"> <span class="link-to-post__prev">&#10535; &nbsp;Previous post</span> <span class="link-to-post__title">Как создать шаблон для сайта на 1С-Битрикс</span> </a></div></div></article></main><footer class="blog-footer content-wrapper"><p>&copy; <span class="full-year"></span> denisnovikov.github.io</footer><script src="/assets/js/scripts.js"></script>  <script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function () { try { w.yaCounter45975960 = new Ya.Metrika({ id: 45975960, clickmap: true, trackLinks: true, accurateTrackBounce: true, webvisor: true }); } catch (e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks"); </script> <noscript><div> <img src="https://mc.yandex.ru/watch/45975960" style="position:absolute; left:-9999px;" alt="" /></div></noscript>  <!--Openstat--> <span id="openstat1"></span> <script type="text/javascript"> var openstat = { counter: 1, next: openstat }; (function(d, t, p) { var j = d.createElement(t); j.async = true; j.type = "text/javascript"; j.src = ("https:" == p ? "https:" : "http:") + "//openstat.net/cnt.js"; var s = d.getElementsByTagName(t)[0]; s.parentNode.insertBefore(j, s); })(document, "script", document.location.protocol); </script> <!--/Openstat-->
