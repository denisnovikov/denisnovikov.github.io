<!DOCTYPE html><html lang="ru"><head>  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-89748707-1"></script> <script> window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'UA-89748707-1'); </script><base href="https://denisnovikov.github.io"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="google-site-verification" content="aiV-7fBXdNhcJILKp5GXFesXJetzCgLWAbif-tZKfrY" /><meta name="yandex-verification" content="41a2ad868168b23f" /><meta name="openstat-verification" content="62f671b1eaa0d2a7ce234219685a42b3d7770961" /><meta property="op:markup_version" content="v1.0"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="application-name" content="FrontEnd Blog"><meta name="format-detection" content="telephone=no"><meta name="generator" content="jekyll"><meta name="google" content="notranslate"><meta name="rating" content="General"><meta name="referrer" content="never"><meta name="robots" content="index,follow,noodp"><meta name="subject" content="blog"><meta name="url" content="https://denisnovikov.github.io"><meta name="viewport" content="width=device-width, initial-scale=1"><title> Мониторинг веб-приложений - denisnovikov.github.io</title><meta name="description" content="В вебе есть множество API для информирования о том, что происходит в вашем приложении. Вы можете мониторить множество вещей и наблюдать практически любые тип..."><link rel="alternate" hreflang="ru" href="/blog/monitoring-web-applications/" /><link rel="canonical" href="https://denisnovikov.github.io/blog/monitoring-web-applications/"><link rel="author" href="DNovikov"><link rel="me" href="https://github.com/denisnovikov" type="text/html"><link rel="me" href="mailto:dnovikov1808@gmail.com"><link href='https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|Roboto+Condensed:700&subset=latin' rel='stylesheet' type='text/css'><link rel="stylesheet" href="/assets/css/main.css"><meta property="og:url" content="https://denisnovikov.github.io/blog/monitoring-web-applications/"><meta property="og:type" content="website"><meta property="og:title" content="Мониторинг веб-приложений"><meta property="og:description" content="В вебе есть множество API для информирования о том, что происходит в вашем приложении. Вы можете мониторить множество вещей и наблюдать практически любые типы изменений"><meta property="og:site_name" content="denisnovikov.github.io"><meta property="og:locale" content="ru_RU"><meta property="article:author" content="DNovikov"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@dev_novikov"><meta name="twitter:creator" content="@dev_novikov"><meta name="twitter:url" content="https://denisnovikov.github.io/blog/monitoring-web-applications/"><meta name="twitter:title" content="Мониторинг веб-приложений"><meta name="twitter:description" content="В вебе есть множество API для информирования о том, что происходит в вашем приложении. Вы можете мониторить множество вещей и наблюдать практически любые типы изменений"><meta property="og:image" content="https://denisnovikov.github.io/assets/images/bg.svg"><meta name="twitter:image" content="https://denisnovikov.github.io/assets/images/bg.svg"><body><div id="shadow"></div><header class="main-header content-wrapper"> <input type="checkbox" id="menu-checkbox" /><nav class="center-wrapper nav-main"> <a class="blog-logo" href="/">denisnovikov.github.io</a> <a href="/about/">О проекте</a> <a href="/blog/">Все записи блога</a> <a href="/feed.xml" rel="alternate" type="application/rss+xml">RSS</a> <label for="menu-checkbox" class="toggle-button" data-open="☰" data-close="☰" onclick></label></nav></header><aside class="sidebar" role="note" style=" background-image: url( /assets/images/front-end/monitoring-web-applications/preview-monitoring-web-applications.svg )"><div class="cover"><div class="cover-text"><div class="heading"> <a href="/blog/#front-end">front-end</a></div><p> В вебе есть множество API для информирования о том, что происходит в вашем приложении. Вы можете мониторить множество вещей и наблюдать практически любые типы изменений Мониторинг веб-приложений</div></div><div id="switcher"></div></aside><main class="content-wrapper"><article class="post"><h1 class="post-title">Мониторинг веб-приложений</h1><p class="post-meta"> <time datetime="2016-08-20">20-08-2016</time> &nbsp;/&nbsp; <span>prgssr.ru</span><div class="post-content"><p>В вебе есть множество API для информирования о том, что происходит в вашем приложении. Вы можете мониторить множество вещей и наблюдать практически любые типы изменений.<p>Эти изменения варьируются от простых вещей типа мутаций DOM и отлова ошибок на клиентской части до более сложных уведомлений типа разрядки батареи устройства пользователя. При этом остается постоянным набор способов взаимодействия с ними: функции обратного вызова, промисы, события.<p>Ниже показаны отдельные примеры их использования, которые я придумал. Этот список совсем не исчерпывающий. В основном это примеры мониторинга структуры приложения, его состояния и свойств устройства, на котором оно выполняется.<h2 id="Прослушиваем-события-dom-как-нативные-так-и-кастомные">Прослушиваем события DOM (как нативные, так и кастомные)</h2><figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="c1">// user scrolls the page.</span><br data-jekyll-commonmark-ghpages="" /><span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'scroll'</span><span class="p">,</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="p">...</span> <span class="p">});</span><br data-jekyll-commonmark-ghpages="" /><br data-jekyll-commonmark-ghpages="" /><span class="nx">el</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'focus'</span><span class="p">,</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="p">...</span> <span class="p">});</span> <span class="c1">// el is focused. img.addEventListener('load', e =&gt; { ... }); // img is done loading.</span><br data-jekyll-commonmark-ghpages="" /><br data-jekyll-commonmark-ghpages="" /><span class="c1">// user types into input.</span><br data-jekyll-commonmark-ghpages="" /><span class="nx">input</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'input'</span><span class="p">,</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="p">...</span> <span class="p">});</span><br data-jekyll-commonmark-ghpages="" /><br data-jekyll-commonmark-ghpages="" /><span class="c1">// catch custom event fired on el.</span><br data-jekyll-commonmark-ghpages="" /><span class="nx">el</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'custom-event'</span><span class="p">,</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="p">...</span> <span class="p">});</span></code></pre></figure><h2 id="Прослушиваем-модификацию-dom">Прослушиваем модификацию DOM</h2><figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">const</span> <span class="nx">observer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MutationObserver</span><span class="p">(</span><span class="nx">mutations</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="p">...</span> <span class="p">});</span> <span class="nx">observer</span><span class="p">.</span><span class="nx">observe</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">,</span> <span class="p">{</span><br data-jekyll-commonmark-ghpages="" />  <span class="na">childList</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span><br data-jekyll-commonmark-ghpages="" />  <span class="na">subtree</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span><br data-jekyll-commonmark-ghpages="" />  <span class="na">attributes</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span><br data-jekyll-commonmark-ghpages="" />  <span class="na">characterData</span><span class="p">:</span> <span class="kc">true</span><br data-jekyll-commonmark-ghpages="" /><span class="p">});</span></code></pre></figure><h2 id="Узнаем-об-изменении-url">Узнаем об изменении URL</h2><figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="nb">window</span><span class="p">.</span><span class="nx">onhashchange</span> <span class="o">=</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">location</span><span class="p">.</span><span class="nx">hash</span><span class="p">);</span> <span class="nb">window</span><span class="p">.</span><span class="nx">onpopstate</span> <span class="o">=</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">location</span><span class="p">,</span> <span class="nx">e</span><span class="p">.</span><span class="nx">state</span><span class="p">);</span></code></pre></figure><h2 id="Узнаем-о-работе-приложения-в-полноэкранном-режиме-подробнее">Узнаем о работе приложения в полноэкранном режиме (<a href="https://developer.mozilla.org/en-US/docs/Web/API/Fullscreen_API">подробнее</a>)</h2><figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'fullscreenchange'</span><span class="p">,</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="p">{</span><br data-jekyll-commonmark-ghpages="" />  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">fullscreenElement</span><span class="p">)</span><br data-jekyll-commonmark-ghpages="" /><span class="p">});</span></code></pre></figure><h2 id="Узнаем-о-поступлении-сообщений-по-webrtc">Узнаем о поступлении сообщений по WebRTC</h2><figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="c1">// Cross-domain / window /worker.</span><br data-jekyll-commonmark-ghpages="" /><span class="nb">window</span><span class="p">.</span><span class="nx">onmessage</span> <span class="o">=</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="p">...</span> <span class="p">};</span><br data-jekyll-commonmark-ghpages="" /><br data-jekyll-commonmark-ghpages="" /><span class="c1">// WebRTC</span><br data-jekyll-commonmark-ghpages="" /><span class="kd">const</span> <span class="nx">dc</span> <span class="o">=</span> <span class="p">(</span><span class="k">new</span> <span class="nx">RTCPeerConnection</span><span class="p">()).</span><span class="nx">createDataChannel</span><span class="p">();</span> <span class="nx">dc</span><span class="p">.</span><span class="nx">onmessage</span> <span class="o">=</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="p">...</span> <span class="p">};</span></code></pre></figure><h2 id="Узнаем-об-ошибках-на-клиентской-стороне-подробнее">Узнаем об ошибках на клиентской стороне (<a href="https://developer.mozilla.org/en-US/docs/Web/API/GlobalEventHandlers/onerror">подробнее</a>)</h2><figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="c1">// Client-size error?</span><br data-jekyll-commonmark-ghpages="" /><span class="nb">window</span><span class="p">.</span><span class="nx">onerror</span> <span class="o">=</span> <span class="p">(</span><span class="nx">msg</span><span class="p">,</span> <span class="nx">src</span><span class="p">,</span> <span class="nx">lineno</span><span class="p">,</span> <span class="nx">colno</span><span class="p">,</span> <span class="nx">error</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="p">...</span> <span class="p">};</span><br data-jekyll-commonmark-ghpages="" /><br data-jekyll-commonmark-ghpages="" /><span class="c1">// Unhandled rejected Promise?</span><br data-jekyll-commonmark-ghpages="" /><span class="nb">window</span><span class="p">.</span><span class="nx">onunhandledrejection</span> <span class="o">=</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">reason</span><span class="p">);</span></code></pre></figure><h2 id="Отслеживаем-изменение-ориентации-экрана-устройства-подробнее">Отслеживаем изменение ориентации экрана устройства (<a href="https://developer.mozilla.org/en-US/docs/Web/Events/orientationchange">подробнее</a>)</h2><figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">const</span> <span class="nx">media</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">matchMedia</span><span class="p">(</span><span class="s1">'(orientation: portrait)'</span><span class="p">);</span> <span class="nx">media</span><span class="p">.</span><span class="nx">addListener</span><span class="p">(</span><span class="nx">mql</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">mql</span><span class="p">.</span><span class="nx">matches</span><span class="p">));</span><br data-jekyll-commonmark-ghpages="" /><br data-jekyll-commonmark-ghpages="" /><span class="c1">// Orientation of device changes.</span><br data-jekyll-commonmark-ghpages="" /><span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'orientationchange'</span><span class="p">,</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="p">{</span><br data-jekyll-commonmark-ghpages="" />  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">screen</span><span class="p">.</span><span class="nx">orientation</span><span class="p">.</span><span class="nx">angle</span><span class="p">)</span><br data-jekyll-commonmark-ghpages="" /><span class="p">});</span></code></pre></figure><h2 id="Отслеживаем-изменения-в-сетевом-соединении-подробнее">Отслеживаем изменения в сетевом соединении (<a href="https://developer.mozilla.org/en-US/docs/Web/API/Network_Information_API">подробнее</a>)</h2><figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="c1">// Online/offline events.</span><br data-jekyll-commonmark-ghpages="" /><span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'online'</span><span class="p">,</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="p">{</span><br data-jekyll-commonmark-ghpages="" />  <span class="nx">console</span><span class="p">.</span><span class="nx">assert</span><span class="p">(</span><span class="nb">navigator</span><span class="p">.</span><span class="nx">onLine</span><span class="p">)</span><br data-jekyll-commonmark-ghpages="" /><span class="p">});</span><br data-jekyll-commonmark-ghpages="" /><span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'offline'</span><span class="p">,</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="p">{</span><br data-jekyll-commonmark-ghpages="" />  <span class="nx">console</span><span class="p">.</span><span class="nx">assert</span><span class="p">(</span><span class="o">!</span><span class="nb">navigator</span><span class="p">.</span><span class="nx">onLine</span><span class="p">)</span><br data-jekyll-commonmark-ghpages="" /><span class="p">});</span><br data-jekyll-commonmark-ghpages="" /><br data-jekyll-commonmark-ghpages="" /><span class="c1">// Network Information API navigator.connection.addEventListener('change', e =&gt; {</span><br data-jekyll-commonmark-ghpages="" />  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nb">navigator</span><span class="p">.</span><span class="nx">connection</span><span class="p">.</span><span class="nx">type</span><span class="p">,</span><br data-jekyll-commonmark-ghpages="" />              <span class="nb">navigator</span><span class="p">.</span><span class="nx">connection</span><span class="p">.</span><span class="nx">downlinkMax</span><span class="p">);</span><br data-jekyll-commonmark-ghpages="" /><span class="p">});</span></code></pre></figure><h2 id="Отслеживаем-состояние-заряда-батареи-устройства-подробнее">Отслеживаем состояние заряда батареи устройства (<a href="https://developer.mozilla.org/en-US/docs/Web/API/Battery_Status_API">подробнее</a>)</h2><figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="nb">navigator</span><span class="p">.</span><span class="nx">getBattery</span><span class="p">().</span><span class="nx">then</span><span class="p">(</span><span class="nx">batt</span> <span class="o">=&gt;</span> <span class="p">{</span><br data-jekyll-commonmark-ghpages="" />    <span class="nx">batt</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'chargingchange'</span><span class="p">,</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="p">{</span><br data-jekyll-commonmark-ghpages="" />    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">batt</span><span class="p">.</span><span class="nx">charging</span><span class="p">);</span><br data-jekyll-commonmark-ghpages="" />  <span class="p">});</span><br data-jekyll-commonmark-ghpages="" />  <span class="nx">batt</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'levelchange'</span><span class="p">,</span><span class="nx">e</span> <span class="o">=&gt;</span> <span class="p">{</span><br data-jekyll-commonmark-ghpages="" />    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">batt</span><span class="p">.</span><span class="nx">level</span><span class="p">);</span><br data-jekyll-commonmark-ghpages="" />  <span class="p">});</span><br data-jekyll-commonmark-ghpages="" />  <span class="nx">batt</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'chargingtimechange'</span><span class="p">,</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="p">{</span><br data-jekyll-commonmark-ghpages="" />    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">batt</span><span class="p">.</span><span class="nx">chargingTime</span><span class="p">);</span><br data-jekyll-commonmark-ghpages="" />  <span class="p">});</span><br data-jekyll-commonmark-ghpages="" />    <span class="nx">batt</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'dischargingtimechange'</span><span class="p">,</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="p">{</span><br data-jekyll-commonmark-ghpages="" />    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">batt</span><span class="p">.</span><span class="nx">dischargingTime</span><span class="p">);</span><br data-jekyll-commonmark-ghpages="" />  <span class="p">});</span><br data-jekyll-commonmark-ghpages="" /><span class="p">});</span></code></pre></figure><h2 id="Узнаем-о-видимостинахождении-в-фокусе-вкладки-или-страницы-подробнее">Узнаем о видимости/нахождении в фокусе вкладки или страницы (<a href="https://developer.mozilla.org/en-US/docs/Web/API/Page_Visibility_API">подробнее</a>)</h2><figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'visibilitychange'</span><span class="p">,</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="p">{</span><br data-jekyll-commonmark-ghpages="" />  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">hidden</span><span class="p">)</span><br data-jekyll-commonmark-ghpages="" /><span class="p">});</span></code></pre></figure><h2 id="Узнаем-о-смене-пользователем-расположения">Узнаем о смене пользователем расположения</h2><figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="nb">navigator</span><span class="p">.</span><span class="nx">geolocation</span><span class="p">.</span><span class="nx">watchPosition</span><span class="p">(</span><span class="nx">pos</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">pos</span><span class="p">.</span><span class="nx">coords</span><span class="p">));</span></code></pre></figure><h2 id="Узнаем-о-изменении-разрешений-на-использование-нужного-api-подробнее">Узнаем о изменении разрешений на использование нужного API (<a href="https://developer.mozilla.org/en-US/docs/Web/API/Permissions_API">подробнее</a>)</h2><figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">const</span> <span class="nx">q</span> <span class="o">=</span> <span class="nb">navigator</span><span class="p">.</span><span class="nx">permissions</span><span class="p">.</span><span class="nx">query</span><span class="p">({</span><span class="na">name</span><span class="p">:</span> <span class="s1">'geolocation'</span><span class="p">});</span> <span class="nx">q</span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">permission</span> <span class="o">=&gt;</span> <span class="p">{</span><br data-jekyll-commonmark-ghpages="" />  <span class="nx">permission</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'change'</span><span class="p">,</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="p">{</span><br data-jekyll-commonmark-ghpages="" />    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">state</span><span class="p">);</span><br data-jekyll-commonmark-ghpages="" />  <span class="p">});</span><br data-jekyll-commonmark-ghpages="" /><span class="p">});</span></code></pre></figure><h2 id="Узнаем-об-обновлении-другой-вкладкой-локального-хранилища-или-хранилища-сессии">Узнаем об обновлении другой вкладкой локального хранилища или хранилища сессии</h2><figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'storage'</span><span class="p">,</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="nx">alert</span><span class="p">(</span><span class="nx">e</span><span class="p">));</span></code></pre></figure><h2 id="Узнаем-о-появлении-или-покидании-элементом-области-видимости-то-есть-о-видимости-элемента-подробнее">Узнаем о появлении или покидании элементом области видимости (то есть о видимости элемента, <a href="https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API">подробнее</a>)</h2><figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">const</span> <span class="nx">observer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">IntersectionObserver</span><span class="p">(</span><span class="nx">changes</span> <span class="o">=&gt;</span> <span class="p">{</span><br data-jekyll-commonmark-ghpages="" />  <span class="p">...</span><br data-jekyll-commonmark-ghpages="" /><span class="p">},</span> <span class="p">{</span><span class="na">threshold</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.25</span><span class="p">]});</span> <span class="nx">observer</span><span class="p">.</span><span class="nx">observe</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#watchMe'</span><span class="p">));</span></code></pre></figure><h2 id="Узнаем-когда-браузер-находится-в-ленивом-режиме-и-готов-выполнить-какую-нибудь-дополнительную-работу-подробнее">Узнаем, когда браузер находится в “ленивом” режиме (и готов выполнить какую-нибудь дополнительную работу, <a href="https://developers.google.com/web/updates/2015/08/using-requestidlecallback?hl=en">подробнее</a>)</h2><figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="nx">requestIdleCallback</span><span class="p">(</span><span class="nx">deadline</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="p">...</span> <span class="p">},</span> <span class="p">{</span><span class="na">timeout</span><span class="p">:</span> <span class="mi">2000</span><span class="p">});</span></code></pre></figure><h2 id="Узнаем-о-загрузке-браузером-ресурса-или-о-записи-метрики-user-timing-подробнее">Узнаем о загрузке браузером ресурса или о записи метрики <a href="https://developer.mozilla.org/en-US/docs/Web/API/User_Timing_API">User Timing</a> (<a href="https://developers.google.com/web/updates/2016/06/performance-observer?hl=en">подробнее</a>)</h2><figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">const</span> <span class="nx">observer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">PerformanceObserver</span><span class="p">(</span><span class="nx">list</span> <span class="o">=&gt;</span> <span class="p">{</span><br data-jekyll-commonmark-ghpages="" />  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">list</span><span class="p">.</span><span class="nx">getEntries</span><span class="p">());</span><br data-jekyll-commonmark-ghpages="" /><span class="p">});</span><br data-jekyll-commonmark-ghpages="" /><span class="nx">observer</span><span class="p">.</span><span class="nx">observe</span><span class="p">({</span><span class="na">entryTypes</span><span class="p">:</span> <span class="p">[</span><span class="s1">'resource'</span><span class="p">,</span> <span class="s1">'mark'</span><span class="p">,</span> <span class="s1">'measure'</span><span class="p">]});</span></code></pre></figure><h2 id="Узнаем-об-изменении-свойств-объекта-включая-свойства-dom-подробнее">Узнаем об изменении свойств объекта (включая свойства DOM, <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy">подробнее</a>)</h2><figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="c1">// Observe changes to a DOM node's .textContent.</span><br data-jekyll-commonmark-ghpages="" /><span class="c1">// From gist.github.com/ebidel/d923001dd7244dbd3fe0d5116050d227</span><br data-jekyll-commonmark-ghpages="" /><br data-jekyll-commonmark-ghpages="" /><span class="kd">const</span> <span class="nx">proxy</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Proxy</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#target'</span><span class="p">),</span> <span class="p">{</span><br data-jekyll-commonmark-ghpages="" />    <span class="kd">set</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">propKey</span><span class="p">,</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">receiver</span><span class="p">)</span> <span class="p">{</span><br data-jekyll-commonmark-ghpages="" />    <span class="k">if</span> <span class="p">(</span><span class="nx">propKey</span> <span class="o">===</span> <span class="s1">'textContent'</span><span class="p">)</span> <span class="p">{</span><br data-jekyll-commonmark-ghpages="" />      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'textContent changed to: '</span> <span class="o">+</span> <span class="nx">value</span><span class="p">);</span><br data-jekyll-commonmark-ghpages="" />    <span class="p">}</span><br data-jekyll-commonmark-ghpages="" />    <span class="nx">target</span><span class="p">[</span><span class="nx">propKey</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span><br data-jekyll-commonmark-ghpages="" />  <span class="p">}</span><br data-jekyll-commonmark-ghpages="" /><span class="p">});</span><br data-jekyll-commonmark-ghpages="" /><span class="nx">proxy</span><span class="p">.</span><span class="nx">textContent</span> <span class="o">=</span> <span class="s1">'Updated content!'</span><span class="p">;</span></code></pre></figure><p>Круто! И, главное, что еще большее количество <a href="https://www.chromestatus.com/features/5558926443544576">API</a> <a href="https://www.chromestatus.com/features/5768542523752448">находится</a> в <a href="https://www.chromestatus.com/features/5662847321243648">разработке</a>.<p>Я предполагаю, что вы могли бы классифицировать некоторые из этих примеров как техники и паттерны (например, реагирование на события DOM). Однако многие совершенно новые API создавались с определенной целью: измерение производительности, информирование о заряде батареи, состояния онлайн или офлайн.<p>Это действительно впечатляет, к каким вещам у веб-разработчиков есть доступ в наши дни. API есть практически для всего.<p align="right"><small><em>Источник: http://prgssr.ru/development/monitoring-veb-prilozhenij.html</em></small><div class="post-links"> <a class="link-to-post" href="/blog/theming-with-sass-neverending-story/"> <span class="link-to-post__next">&#10535; &nbsp;Next post</span> <span class="link-to-post__title">Темизация с Sass: бесконечная история</span> </a> <a class="link-to-post" href="/blog/customize-login-screen-lightdm-gtk-greeter/"> <span class="link-to-post__prev">&#10535; &nbsp;Previous post</span> <span class="link-to-post__title">Настройка экрана входа lightdm-gtk-greeter</span> </a></div></div></article></main><footer class="blog-footer content-wrapper"><p>&copy; <span class="full-year"></span> denisnovikov.github.io</footer><script src="/assets/js/scripts.js"></script>  <script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function () { try { w.yaCounter45975960 = new Ya.Metrika({ id: 45975960, clickmap: true, trackLinks: true, accurateTrackBounce: true, webvisor: true }); } catch (e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks"); </script> <noscript><div> <img src="https://mc.yandex.ru/watch/45975960" style="position:absolute; left:-9999px;" alt="" /></div></noscript>  <!--Openstat--> <span id="openstat1"></span> <script type="text/javascript"> var openstat = { counter: 1, next: openstat }; (function(d, t, p) { var j = d.createElement(t); j.async = true; j.type = "text/javascript"; j.src = ("https:" == p ? "https:" : "http:") + "//openstat.net/cnt.js"; var s = d.getElementsByTagName(t)[0]; s.parentNode.insertBefore(j, s); })(document, "script", document.location.protocol); </script> <!--/Openstat-->
