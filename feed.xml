<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="ru"><generator uri="https://jekyllrb.com/" version="3.6.2">Jekyll</generator><link href="https://denisnovikov.github.io/feed.xml" rel="self" type="application/atom+xml" /><link href="https://denisnovikov.github.io/" rel="alternate" type="text/html" hreflang="ru" /><updated>2017-12-15T09:00:58+03:00</updated><id>https://denisnovikov.github.io/</id><title type="html">denisnovikov.github.io</title><subtitle>Хранилище разнообразной информации</subtitle><entry><title type="html">Черные методы продвижения сайтов. Что не стоит делать, если хотите вывести сайт в ТОП</title><link href="https://denisnovikov.github.io/blog/black-website-promotion-how-not-to-do/" rel="alternate" type="text/html" title="Черные методы продвижения сайтов. Что не стоит делать, если хотите вывести сайт в ТОП" /><published>2017-10-30T21:15:00+03:00</published><updated>2017-10-30T21:15:00+03:00</updated><id>https://denisnovikov.github.io/blog/black-website-promotion-how-not-to-do</id><content type="html" xml:base="https://denisnovikov.github.io/blog/black-website-promotion-how-not-to-do/">&lt;p&gt;Задача владельцев сайтов — поднять свой ресурс на самое высокое место в поисковой выдаче. Они готовы сделать все, чтобы увидеть свой проект в ТОПе: кто-то применяет белые методы продвижения сайта, а кто-то не прочь воспользоваться и черным продвижением, лишь бы его детище было на вершине.&lt;/p&gt;

&lt;p&gt;Поисковые системы уже давно научились распознавать недобросовестные манипуляции, разрабатывая новые алгоритмы. Они стараются избавиться от сайтов, которые продвигаются нечестным путем, и отдают предпочтение только качественным и грамотно оптимизированным ресурсам.&lt;/p&gt;

&lt;h2 id=&quot;Черные-методы-раскрутки-которые-мыНЕ-рекомендуем&quot;&gt;Черные методы раскрутки, которые мы НЕ рекомендуем&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;Спам.&lt;/strong&gt; Не пытайтесь упоминать о своем ресурсе везде, особенно там, где это не уместно. Информация о вашем сайте на форумах, в блогах, на досках объявлений, в рассылках должна быть по делу. Не стоит, например, размещать рекламу о сайте с кальянами на форуме молодых мам.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Обмен и покупка ссылок.&lt;/strong&gt; Начиная с 2013 года, Яндекс стал активно бороться с некачественными ссылками. Многие владельцы сайтов с большим количеством входящих ссылок столкнулись с Минусинском. Не занимайтесь покупкой ссылок, все ссылки должны быть с хороших ресурсов, тематически подходящих вашему. Помните, что для ссылочной массы сейчас важно не количество, а их качество.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Дорвеи и клоакинг.&lt;/strong&gt; Дорвей — сайт, созданный для перенаправления пользователя на продвигаемый ресурс. Для перенаправления используется redirect. Содержимое таких страниц состоит из бессвязных предложений с огромным количеством ключевых запросов. Такие сайты захламляют просторы Интернета и жестоко караются поисковыми системами.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Размещение невидимого или плохо заметного текста.&lt;/strong&gt; Размещение такого текста грозит получением фильтра от Яндекса, поисковики страницы со скрытым текстом исключают из поиска.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Накрутка поведенческих факторов.&lt;/strong&gt; Когда-то можно было повлиять на выдачу за счет накрутки ПФ, но сейчас поисковики умеют определять, был ли применен данный инструмент и все ли показатели естественные. Не заказывайте накрутку поведенческих факторов у посредников, ни к чему хорошему это не приведет.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Переспам текста ключевыми запросами.&lt;/strong&gt; Все чаще владельцы сайтов сталкиваются с фильтром Баден-Баден, борющимся с текстовым спамом. Лайфхак от копирайтеров: на 300–500 символов рекомендуется использовать 1 ключевой запрос.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Много ссылок и кнопок на главной странице.&lt;/strong&gt; Допустимо, если в этом есть реальная необходимость.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Flash-анимация.&lt;/strong&gt; Такие сайты продвигать очень трудно. Найти их в ТОПе практически невозможно, но исключения бывают. Старайтесь не строить свой ресурс полностью на flash-элементах.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Каждый владелец веб-сайта должен поставить перед собой задачу не просто раскрутить свой проект, а сделать его интересным и удобным для пользователей. Сайты создаются в первую очередь для людей, а поисковые системы всячески способствуют тому, чтобы ресурсы развивались и были качественными.&lt;/p&gt;

&lt;h2 id=&quot;Несколько-советов-как-продвигать-сайт&quot;&gt;Несколько советов, как продвигать сайт&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;Уделите внимание дизайну вашего сайта и удобству для посетителей.&lt;/strong&gt; Дизайн должен быть приятным, без ярких режущих глаз цветов. Делайте цветовую гамму размеренной, сочетайте шрифты. Создайте удобное меню, чтобы человек не ломал голову, где и что искать ему на сайте.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Грамотно оптимизируйте контент&lt;/strong&gt; (составьте семантическое ядро, оптимизируйте под него тексты, метатеги и пр.).&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Настройте все технические параметры&lt;/strong&gt; (правильно подберите URL (лучше если ЧПУ будут с включением ключевых запросов), настройте файлы sitemap.xml и robots.txt для правильной индексации сайта, настройте редиректы для зеркал сайта, исключите все дубли, настройте разметку контактов и карточек товаров и т. д.).&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Добавьте сайт в Вебмастера&lt;/strong&gt; Яндекса, Гугла, также нелишним будет добавление в Майле и Бинге.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Займитесь узнаваемостью сайта (компании) в сети.&lt;/strong&gt; Добавьте информацию о сайте на самые популярные площадки Интернета (Яндекс и Гугл Карты, справочники организаций (2ГИС, Фламп, Желтые страницы и др.)).&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Займитесь наращиванием ссылочной массы,&lt;/strong&gt; но помните, что выше мы говорили о покупных и обменных ссылках. Еще один лайфхак: ссылки можно получать с помощью крауд-маркетинга, но делать это нужно правильно.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Разработайте мобильную версию сайта.&lt;/strong&gt; Пользователей из мобильных источников становится все больше и больше, сделайте свой ресурс удобным для просмотра на смартфонах и планшетах.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Используйте SMM-продвижение.&lt;/strong&gt; Продвижение в социальных сетях очень актуально в наше время. Большая ошибка — пренебрегать созданием групп в соцсетях и их продвижением.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Всегда помните о своем проекте.&lt;/strong&gt; Не забывайте вовремя оплачивать хостинг и домен. Если робот или пользователь зайдут на неработающий сайт из-за несвоевременной оплаты, это скажется только отрицательно. Также всегда старайтесь обновлять контент, особенно это важно для новостных ресурсов. Если на сайте есть новости, обновляйте их хотя бы раз в месяц, чтобы пользователь видел, что над ресурсом работают.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Данные рекомендации общие, каждый сайт имеет свою направленность. Сайт интернет-магазина и портал продвигаются разными способами, и план раскрутки для каждого будет свой.&lt;/p&gt;</content><author><name>1ps.ru</name></author><category term="other" /><summary type="html">Задача владельцев сайтов — поднять свой ресурс на самое высокое место в поисковой выдаче. Они готовы сделать все, чтобы увидеть свой проект в ТОПе: кто-то применяет белые методы продвижения сайта, а кто-то не прочь воспользоваться и черным продвижением, лишь бы его детище было на вершине.</summary></entry><entry><title type="html">Как изменить мета теги для определенных разделов в 1С-Битрикс</title><link href="https://denisnovikov.github.io/blog/how-to-change-meta-tags-for-certain-sections-to-1c-bitrix/" rel="alternate" type="text/html" title="Как изменить мета теги для определенных разделов в 1С-Битрикс" /><published>2017-10-10T00:00:01+03:00</published><updated>2017-10-10T00:00:01+03:00</updated><id>https://denisnovikov.github.io/blog/how-to-change-meta-tags-for-certain-sections-to-1c-bitrix</id><content type="html" xml:base="https://denisnovikov.github.io/blog/how-to-change-meta-tags-for-certain-sections-to-1c-bitrix/">&lt;p&gt;Для того чтобы изменить шаблоны для целых разделов в битриксе, нужно всего-лишь пара строчек кода.&lt;/p&gt;

&lt;p&gt;Вы уже могли читать на этом блоге &lt;a href=&quot;http://forwww.com/bitrix-how-to-show-information-on-the-main-page/&quot;&gt;Как отображать информацию только на главной странице&lt;/a&gt;, а если нет — обязательно сделайте это.&lt;/p&gt;

&lt;p&gt;Для более лучшего понимания статьи я также вам рекомендую прочесть &lt;a href=&quot;http://forwww.com/how-set-meta-in-bitrix/&quot;&gt;Как задавать мета свойства в 1С-Битрикс&lt;/a&gt;, поверьте, сегодня нам это всё понадобится.&lt;/p&gt;

&lt;h2 id=&quot;Как-задать-тайтл-ключевые-слова-и-дескрипшен-для-определенного-раздела-в-битриксе&quot;&gt;Как задать тайтл, ключевые слова и дескрипшен для определенного раздела в битриксе&lt;/h2&gt;

&lt;p&gt;Для самых ленивых небольшой фрагмент кода:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$APPLICATION&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;SetPageProperty&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;title&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$myTitle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;span class=&quot;nv&quot;&gt;$APPLICATION&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;SetPageProperty&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;keywords&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$myKeywords&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;span class=&quot;nv&quot;&gt;$APPLICATION&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;SetPageProperty&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;description&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$myDescription&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Именно так можно повлиять на мета свойства &lt;strong&gt;title&lt;/strong&gt;, &lt;strong&gt;description&lt;/strong&gt; и &lt;strong&gt;keywords&lt;/strong&gt;. Не забывайте, что вам нужно перед этим записать что-то в соответствующие переменные.&lt;/p&gt;

&lt;p&gt;Ну а теперь что касается самого решения — как же можно повлиять на SEO данные?&lt;/p&gt;

&lt;p&gt;Данный код помещаем в самый низ футера вашего шаблона (&lt;em&gt;footer.php&lt;/em&gt;):&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;CSite&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;InDir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'/catalog'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;CSite&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;InDir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'/manufacturing'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;	&lt;span class=&quot;nv&quot;&gt;$TITLE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$APPLICATION&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;sDocTitle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;	&lt;span class=&quot;nv&quot;&gt;$myTitle&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$TITLE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;' – купить недорого в Москве с доставкой'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;	&lt;span class=&quot;nv&quot;&gt;$myDescription&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$TITLE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;' – купить по низкой цене у лучших поставщиков.'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;	&lt;span class=&quot;nv&quot;&gt;$APPLICATION&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;SetPageProperty&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;title&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$myTitle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;	&lt;span class=&quot;nv&quot;&gt;$APPLICATION&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;SetPageProperty&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;description&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$myDescription&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;span class=&quot;k&quot;&gt;endif&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Для решения поставленной задачи мы использовали &lt;strong&gt;CSite::InDir&lt;/strong&gt;, текущий заголовок мы брали при помощи &lt;strong&gt;$APPLICATION&lt;/strong&gt; — в этом объекте много чего хранится, но нас интересовало лишь свойство &lt;strong&gt;sDocTitle&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;Сейчас в битриксе часто используют вкладку SEO, в которой можно удобно настроить шаблоны как для элементов так и для разделов, но это уже совсем другая история.&lt;/p&gt;</content><author><name>forwww.com</name></author><category term="bitrix" /><summary type="html">Для того чтобы изменить шаблоны для целых разделов в битриксе, нужно всего-лишь пара строчек кода.</summary></entry><entry><title type="html">Open Graph разметка в 1С-Битрикс</title><link href="https://denisnovikov.github.io/blog/open-graph-markup-to-1c-bitrix/" rel="alternate" type="text/html" title="Open Graph разметка в 1С-Битрикс" /><published>2017-09-22T00:00:01+03:00</published><updated>2017-09-22T00:00:01+03:00</updated><id>https://denisnovikov.github.io/blog/open-graph-markup-to-1c-bitrix</id><content type="html" xml:base="https://denisnovikov.github.io/blog/open-graph-markup-to-1c-bitrix/">&lt;p&gt;Open Graph — это стандарт метатегов, разработанный соц.сетью Facebook для передачи информации различным сервисам о содержании страницы.&lt;/p&gt;

&lt;p&gt;Стандартной разметкой Open Graph пользуется большинство популярных социальных сетей Facebook, Вконтакте, Google+, Twitter, LinkedIn, Pinterest и другие.&lt;/p&gt;

&lt;p&gt;Данные добавляются в секцию &amp;lt;head&amp;gt; в виде метатегов:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;meta&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;property=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;og:url&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;content=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;https://keengo.ru&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;В качестве свойств данной разметкой могут передаваться следующие параметры:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;og:url&lt;/strong&gt; — ссылка на страницу&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;og:type&lt;/strong&gt; — тип передаваемого объекта&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;og:title&lt;/strong&gt; — заголовок страницы или объекта&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;og:description&lt;/strong&gt; — описание страницы или объекта&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;og:image&lt;/strong&gt; — превью изображение&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Как же добавить данные параметры в шапку шаблона 1С-Битрикс, чтобы они автоматически отображали информацию текущей страницы, которой делится в соц.сети пользователь?&lt;/p&gt;

&lt;p&gt;Для начала определим некоторые параметры, которые так же пригодятся для дальнейшего использования на сайте, в самом начале файла header.php вашей темы добавляем код:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;span class=&quot;nb&quot;&gt;define&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;SITE_SERVER_PROTOCOL&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;CMain&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;IsHTTPS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;https://&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;http://&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// Переменная определяет протокол, по которому работает ваш сайт&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$curPage&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$APPLICATION&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;GetCurPage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// Получаем текущий адрес страницы&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Затем в секции &amp;lt;head&amp;gt; добавляем наши метатеги с параметрами для вывода Open Graph разметки:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;meta&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;property=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;og:url&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;content=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;SITE_SERVER_PROTOCOL&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;SITE_SERVER_NAME&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$curPage&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;meta&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;property=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;og:type&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;content=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;website&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;meta&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;property=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;og:title&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;content=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$APPLICATION&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;ShowProperty&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;title&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;meta&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;property=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;og:description&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;content=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$APPLICATION&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;ShowProperty&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;description&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;meta&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;property=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;og:image&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;content=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$APPLICATION&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;ShowProperty&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;og:image&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Для вывода og:url воспользовались конструкцией, которая формирует полную ссылку на текущую страницу:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;SITE_SERVER_PROTOCOL&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;SITE_SERVER_NAME&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$curPage&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Параметр og:type в нашем случае принимает значение website.&lt;/p&gt;

&lt;p&gt;Для вывода заголовка og:title и описания og:description воспользовались функцией 1С-Битрикс $APPLICATION-&amp;gt;ShowProperty, которая является отложенной функцией и позволяет выводить информацию выше того места, где она была задана. Т.е. при формировании страницы из блока новости, в заголовок будет попадать информация из title и description текущей новости, а не стандартные параметры раздела.&lt;/p&gt;

&lt;p&gt;Остается последний очень важный параметр — превью нашей записи. Изображение можно создать из детальной картинки записи, обрезав его под размер 1200х630 px и передать в параметр og:image. Но при включенном автокешировании данные перестанут передаваться, когда страница будет загружена из кеша и вся конструкция развалится. Для этого необходимо сделать следующее:&lt;/p&gt;

&lt;p&gt;1) В папке с шаблоном детальной страницы создать файл &lt;strong&gt;result_modifier.php&lt;/strong&gt; и в нем добавить параметры, которые будут передаваться после кеширования:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;span class=&quot;c1&quot;&gt;// Создаем изображение для превью соц.сетей&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$image_social&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;CFile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;ResizeImageGet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$arResult&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;DETAIL_PICTURE&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'width'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'1200'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'height'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'630'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;BX_RESIZE_IMAGE_EXACT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;span class=&quot;nv&quot;&gt;$arResult&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;DETAIL_PICTURE&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;SOCIAL&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$image_social&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;src&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;span class=&quot;c1&quot;&gt;// Передаем данные в результат после кеширования&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;__component&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;SetResultCacheKeys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;	&lt;span class=&quot;s2&quot;&gt;&quot;DETAIL_PICTURE&quot;&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;2) Далее добавляем файл component_epilog.php, который формируется уже после вывода информации из кеша и в нем добавляем код, задающий изображение:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;span class=&quot;nv&quot;&gt;$APPLICATION&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;SetPageProperty&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;og:image&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;SITE_SERVER_PROTOCOL&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;SITE_SERVER_NAME&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$arResult&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'DETAIL_PICTURE'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'SOCIAL'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Вот таким способом мы можем добавить информацию о разметке Open Graph в шапку шаблона 1С-Битрикс.&lt;/p&gt;

&lt;p&gt;Поделимся еще полезной ссылкой, которая позволяет проверить вид ссылок, которые будут публиковаться в Facebook и устранить ошибки: &lt;a href=&quot;https://developers.facebook.com/tools/debug/&quot;&gt;https://developers.facebook.com/tools/debug/&lt;/a&gt;&lt;/p&gt;</content><author><name>keengo.ru</name></author><category term="bitrix" /><summary type="html">Open Graph — это стандарт метатегов, разработанный соц.сетью Facebook для передачи информации различным сервисам о содержании страницы.</summary></entry><entry><title type="html">Параллельное выполнение ssh команд на серверах</title><link href="https://denisnovikov.github.io/blog/parallel-execution-of-ssh-commands-on-servers/" rel="alternate" type="text/html" title="Параллельное выполнение ssh команд на серверах" /><published>2017-08-22T17:28:39+03:00</published><updated>2017-08-22T17:28:39+03:00</updated><id>https://denisnovikov.github.io/blog/parallel-execution-of-ssh-commands-on-servers</id><content type="html" xml:base="https://denisnovikov.github.io/blog/parallel-execution-of-ssh-commands-on-servers/">&lt;p&gt;При управлении большим количеством серверов часто приходится выполнять одну и ту же команду сразу на нескольких серверах (десятках/сотнях/тысячах).&lt;/p&gt;

&lt;p&gt;Существует немало инструментов для решения этой задачи. В .io мы применяем простое решение pssh.&lt;/p&gt;

&lt;p&gt;На Ubuntu этот инструмент доступен в пакетах:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;apt-get install pssh&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Перед использованием инструмента необходимо подготовить текстовые файлы с адресами серверов в формате:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;10.10.0.1&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;10.10.0.2&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;10.10.0.3&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;...&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;em&gt;Список IP серверов для выполнения команд с помощью pssh&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Мы активно используем микросервисную архитектуру, поэтому у нас есть десятки сервисов. Поэтому мы создали общий файл со списком всех серверов и по файлу для каждого сервиса:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;all.txt&lt;/code&gt; хранит список всех серверов системы. Используется крайне редко;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;serviceX.txt&lt;/code&gt; хранит список всех серверов конкретного сервиса.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Для выполнения команды на всех серверах:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;parallel-ssh &lt;span class=&quot;nt&quot;&gt;-h&lt;/span&gt; all.txt &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; /tmp/ssh &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;em&gt;Выполнит команду “ls -la” на всех серверах из файл all.txt&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Результат команды будет записан в папку &lt;code class=&quot;highlighter-rouge&quot;&gt;/tmp/ssh&lt;/code&gt; — в отдельный файл для каждого сервера:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;# ls -la /tmp/ssh/&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;     1 root     root      1238 Aug 22 16:46 10.10.0.1&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;     1 root     root      1269 Aug 22 16:46 10.10.0.2&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;     1 root     root      1110 Aug 22 16:46 10.10.0.3&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;     1 root     root       950 Aug 22 16:46 10.10.0.4&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Для использовании авторизации по ключам:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;parallel-ssh &lt;span class=&quot;nt&quot;&gt;-h&lt;/span&gt; all.txt &lt;span class=&quot;nt&quot;&gt;-x&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;-i key.rsa&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; /tmp/ssh &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;em&gt;key.rsa будет использовать для доступа ко всем серверам&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Вы можете вручную задать количество потоков для выполнения команд:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;parallel-ssh &lt;span class=&quot;nt&quot;&gt;-h&lt;/span&gt; all.txt &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 10 &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; /tmp/ssh &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;em&gt;команды будут выполняться в 10 потоков&lt;/em&gt;&lt;/p&gt;

&lt;h2 id=&quot;tldr&quot;&gt;TL;DR&lt;/h2&gt;

&lt;p&gt;Используйте &lt;a href=&quot;https://github.com/robinbowes/pssh&quot;&gt;pssh&lt;/a&gt; для выполнения команд на большом количестве серверов:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;parallel-ssh &lt;span class=&quot;nt&quot;&gt;-h&lt;/span&gt; all.txt &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; /tmp/ssh &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;em&gt;В all.txt нужно добавить список серверов, каждый ip адрес на новой строке&lt;/em&gt;&lt;/p&gt;</content><author><name>ruhighload.com</name></author><category term="linux" /><summary type="html">При управлении большим количеством серверов часто приходится выполнять одну и ту же команду сразу на нескольких серверах (десятках/сотнях/тысячах).</summary></entry><entry><title type="html">Как вывести имя раздела и ссылку на него в 1С-Битрикс</title><link href="https://denisnovikov.github.io/blog/how-do-i-output-section-name-and-link-to-it-in-1c-bitrix/" rel="alternate" type="text/html" title="Как вывести имя раздела и ссылку на него в 1С-Битрикс" /><published>2017-07-05T00:00:01+03:00</published><updated>2017-07-05T00:00:01+03:00</updated><id>https://denisnovikov.github.io/blog/how-do-i-output-section-name-and-link-to-it-in-1c-bitrix</id><content type="html" xml:base="https://denisnovikov.github.io/blog/how-do-i-output-section-name-and-link-to-it-in-1c-bitrix/">&lt;p&gt;Зная ID раздела, в битриксе очень просто вывести его имя, а также узнать, по какой ссылке он доступен.&lt;/p&gt;

&lt;p&gt;Ссылка формируется из настроек инфоблока. Чтобы все ваши ссылки отображались корректно, настройки внутри инфоблока и вашего компонента должны совпадать.&lt;/p&gt;

&lt;p&gt;Для того чтобы вывести имя раздела будем использовать &lt;strong&gt;API Битрикса&lt;/strong&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;span class=&quot;nv&quot;&gt;$res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;CIBlockSection&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;GetByID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$arItem&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'IBLOCK_SECTION_ID'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]);&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;span class=&quot;nv&quot;&gt;$ar_res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$res&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;GetNext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;a&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$ar_res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'SECTION_PAGE_URL'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt; &lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$ar_res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'NAME'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt; &lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;/a&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;$arItem[‘IBLOCK_SECTION_ID’]&lt;/strong&gt; — ID раздела, имя которого мы хотим вывести;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;$ar_res[‘SECTION_PAGE_URL’]&lt;/strong&gt;  — ссылка на раздел;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;$ar_res[‘NAME’]&lt;/strong&gt;  — имя раздела.&lt;/li&gt;
&lt;/ul&gt;</content><author><name>forwww.com</name></author><category term="bitrix" /><summary type="html">Зная ID раздела, в битриксе очень просто вывести его имя, а также узнать, по какой ссылке он доступен.</summary></entry><entry><title type="html">Как в шаблоне выводить информацию на всех страницах, кроме главной</title><link href="https://denisnovikov.github.io/blog/as-in-template-display-information-on-all-pages-except-main-one-to-1c-bitrix/" rel="alternate" type="text/html" title="Как в шаблоне выводить информацию на всех страницах, кроме главной" /><published>2017-06-20T00:00:01+03:00</published><updated>2017-06-20T00:00:01+03:00</updated><id>https://denisnovikov.github.io/blog/as-in-template-display-information-on-all-pages-except-main-one-to-1c-bitrix</id><content type="html" xml:base="https://denisnovikov.github.io/blog/as-in-template-display-information-on-all-pages-except-main-one-to-1c-bitrix/">&lt;p&gt;Очень часто бывает ситуация когда нам нужно вывести информацию для всех разделов сразу, но исключив корневую страницу. Рассмотрим пример как это сделать.&lt;/p&gt;

&lt;h2 id=&quot;1С-Битрикс--Как-вывести-блок-с-заголовком-для-всех-страниц-кроме-главной&quot;&gt;1С-Битрикс — Как вывести блок с заголовком для всех страниц кроме главной&lt;/h2&gt;

&lt;p&gt;Необходимо создать условие — &lt;strong&gt;показывать код на всех страницах кроме главной&lt;/strong&gt;. Этот код можно записать в шаблоне вашего сайта.&lt;/p&gt;

&lt;p&gt;Код для header.php нашего шаблона:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$APPLICATION&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;GetCurPage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;SITE_DIR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;    &lt;span class=&quot;nt&quot;&gt;&amp;lt;section&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;main&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;        &lt;span class=&quot;nt&quot;&gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;container&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;            &lt;span class=&quot;nt&quot;&gt;&amp;lt;h1&amp;gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$APPLICATION&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;ShowTitle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;/h1&amp;gt;&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;endif&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Код для &lt;strong&gt;footer.php&lt;/strong&gt; шаблона:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$APPLICATION&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;GetCurPage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;SITE_DIR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/section&amp;gt;&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;endif&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Мы используем &lt;strong&gt;GetCurPage&lt;/strong&gt; и выводим заголовок только на тех страницах, на которых соблюдается условие. &lt;strong&gt;SITE_DIR&lt;/strong&gt; — константа, которая отвечает за папку сайта (чаще всего используется в многосайтовости). Таким образом можно править код шаблона в 1С-Битрикс, и применять данный метод в своих скриптах и компонентах.&lt;/p&gt;</content><author><name>forwww.com</name></author><category term="bitrix" /><summary type="html">Очень часто бывает ситуация когда нам нужно вывести информацию для всех разделов сразу, но исключив корневую страницу. Рассмотрим пример как это сделать.</summary></entry><entry><title type="html">Oh My Zsh!</title><link href="https://denisnovikov.github.io/blog/oh-my-zsh/" rel="alternate" type="text/html" title="Oh My Zsh!" /><published>2017-06-19T14:36:00+03:00</published><updated>2017-06-19T14:36:00+03:00</updated><id>https://denisnovikov.github.io/blog/oh-my-zsh</id><content type="html" xml:base="https://denisnovikov.github.io/blog/oh-my-zsh/">&lt;p&gt;Хочу поделиться очень отличным шелом, а по большей части, фреймворком созданным для него, который превратит вашу консоль в очень информативный и продуктивный инструмент.&lt;/p&gt;

&lt;p&gt;Данный материал пригодет только для пользователей unix-подобных систем, а именно Linux и MacOS. На MacOS не знаю что да как, но судя по всему установка и настройка совершенно не отличаются друг от друга. Соответственно его можно ставить и на веб-сервера.&lt;/p&gt;

&lt;h2 id=&quot;Что-это-и-зачем-оно&quot;&gt;Что это и зачем оно&lt;/h2&gt;

&lt;p&gt;Немного введу в курс дела, чтобы вы понимали что это такое и что оно даст. Во-первых, потребуется установить новую оболочку для терминала Zsh и переключиться на неё (кто не в курсе, они живут рядом с друг-другом и не затирают аналоги, так что можно всегда вернуться обратно, например на bash в ubuntu, + можно каждому юзеру выбирать свою, так что это совершенно безопасно). Во-вторых, мы поставим фреймворк для Zsh, который позволяет писать различные плагины, темы и т.д. для данной оболочки, что, собственно, и делает её такой удобой, так как люди написали кучу годноты.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/images/linux/oh-my-zsh/oh-my-zsh-01.png&quot;&gt;&lt;img src=&quot;/assets/images/linux/oh-my-zsh/oh-my-zsh-01.png&quot; alt=&quot;Пример с GitHub&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Я не могу вам описать всех возможностей, ибо некоторые из них не так заметны и не сразу бросаются в глаза. Например, при указании пути до файла\папки Tab в Zsh, делает то же самое что и в bash, но куда круче, а я заметил это спустя неделю, так как не обращал внимания. Он мало того что может учитывать регистры папок и поправлять вас, так и список папок также можно визуально перебирать табом, что просто очень удобно и ускоряет работу.&lt;/p&gt;

&lt;p&gt;Я вообще изначально ставил данный шелл и фреймворк только ради Git плагина, который показывает (если вы находитесь в папках с репозиторием), актуально ли текущее состояние репозитория, в какой ветке находимся, имеются ли новые изменения в файлах, есть ли коммиты или изменения. В общем всю необходимую информацию. Не нужно проверять ветку через &lt;code class=&quot;highlighter-rouge&quot;&gt;git branch -v&lt;/code&gt;, проверять есть ли изменения через &lt;code class=&quot;highlighter-rouge&quot;&gt;git status&lt;/code&gt; и т.д.&lt;/p&gt;

&lt;p&gt;У него есть куча интеграций с различными программами и системными утилитами, которые позволяют сделать работу с терминалом намного, намного приятнее. Ведь, особенно, с Drupal 8, работать с ним нужно все чаще и больше.&lt;/p&gt;

&lt;h2 id=&quot;Установка-zsh-и-oh-my-zsh&quot;&gt;Установка Zsh и Oh My Zsh&lt;/h2&gt;

&lt;p&gt;Первым делом нужно установить оболочку Zsh, для этого в Ubuntu необходимо просто запросить данный пакет, так как он находится в официальных репозиториях:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;apt install zsh&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Далее нам необходимо поставить фреймворк &lt;a href=&quot;https://github.com/robbyrussell/oh-my-zsh&quot;&gt;Oh My Zsh&lt;/a&gt;. Разработчики предлагают два варианта установки, по сути они одинаковые, вам просто предоставляется выбор как вытянуть скрипт установщика, &lt;code class=&quot;highlighter-rouge&quot;&gt;wget&lt;/code&gt; или &lt;code class=&quot;highlighter-rouge&quot;&gt;curl&lt;/code&gt;, это лишь важно в тех случаях, когда на системе нет одного из них (частенько можно встретить отсутствие curl), и вы не хотите ставить пакет ради этого, или нет прав. Я также пишу вам два варианта, а какой использовать решайте сами:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;# curl&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;sh &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;curl &lt;span class=&quot;nt&quot;&gt;-fsSL&lt;/span&gt; https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;span class=&quot;c&quot;&gt;# wget&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;sh &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;wget https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh &lt;span class=&quot;nt&quot;&gt;-O&lt;/span&gt; -&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;После данной установки, у вас запросят пароль чтобы переключить шел для текущего пользователя на Zsh. Вводим, и всё готово!&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/images/linux/oh-my-zsh/oh-my-zsh-02.png&quot;&gt;&lt;img src=&quot;/assets/images/linux/oh-my-zsh/oh-my-zsh-02.png&quot; alt=&quot;Oh My Zsh после установки&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Из коробки он хоть уже и дает больше информации, как по мне, он выглядит хуже оригинального. Для этого в OMZ есть поддержка тем и плагинов, которые могут в корне менять оболочку.&lt;/p&gt;

&lt;h2 id=&quot;Где-и-что-находится&quot;&gt;Где и что находится&lt;/h2&gt;

&lt;p&gt;Данный раздел я не мог упустить так как он может очень сильно помочь в дальнейшем. Фреймворк Oh My Zsh находится в папке ~/.oh-my-zsh — там, в свою очередь, находятся все файлы фреймворка. А сама папка ничто иное как репозиторий Oh My Zsh. Но удалять папку просто так не стоит, там для этого есть специальный скрипт, ниже напишу как.&lt;/p&gt;

&lt;p&gt;Все настройки для Oh My Zsh находятся в файле ~/.zshrc. О нем подробнее будет ниже.&lt;/p&gt;

&lt;h2 id=&quot;Установка-плагинов&quot;&gt;Установка плагинов&lt;/h2&gt;

&lt;p&gt;Начнем с установки нужных нам плагинов. Из коробки там стоит только git, больше никакие плагины не активированы. Список всех додступных плагинов поставляемых с фреймворком можно посмотреть на &lt;a href=&quot;https://github.com/robbyrussell/oh-my-zsh/wiki/Plugins&quot;&gt;странице wiki&lt;/a&gt;, с описанием для чего они используются.&lt;/p&gt;

&lt;p&gt;Например я хочу поставить себе следующие плагины:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;npm&lt;/strong&gt; — добавлят поддержку автодополнения к команде npm&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;vagrant&lt;/strong&gt; — так как я часто пользуюсь vagrant из-за Drupal VM, то мне он тоже не помешает. Также как и npm добавляет поддержку автодополнения. Там же есть и &lt;strong&gt;docker&lt;/strong&gt;;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;composer&lt;/strong&gt; — в 8-ке очень активно использую composer, а данный плагин опять же, добавляет автодополнение, и помимо этого различные полезные синонимы команд. Например &lt;code class=&quot;highlighter-rouge&quot;&gt;cu&lt;/code&gt; = &lt;code class=&quot;highlighter-rouge&quot;&gt;composer update&lt;/code&gt;;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;sudo&lt;/strong&gt; — частенько бывает и такое, что вбиваешь или копируешь команду из интернета, но для неё требуются права супер-пользователя. Постоянно переводить курсор и дописывать муторно, а данный плагин позволяет просто нажать два раза &lt;code class=&quot;highlighter-rouge&quot;&gt;Esc&lt;/code&gt;, и он сам добавит sudo в начало команды;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;web-search&lt;/strong&gt; — а иногда случается ситуация, что роешься в консоли и забыл какую-то команду, нужно гуглануть, и чтобы не переключаться на браузер, не кликать на строку поиска, данный плагин позволяет написать &lt;code class=&quot;highlighter-rouge&quot;&gt;google drupal 8 composer&lt;/code&gt;, и в браузере по умолчанию сразу откроются результаты.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Там куча других плагинов, можно писать свои, выбирайте на свой вкус и под свои задачи, я продолжу гайд как поставить указаныне выше плагины (остальные ставятся абсолютно также).&lt;/p&gt;

&lt;p&gt;Для того чтобы включить данные плагины (они уже есть в комплекте), достаточно отредактировать файл &lt;code class=&quot;highlighter-rouge&quot;&gt;~/.zshrc&lt;/code&gt;. Для этого, в ubuntu, достаточно написать &lt;code class=&quot;highlighter-rouge&quot;&gt;nano ~/.zshrc&lt;/code&gt; или &lt;code class=&quot;highlighter-rouge&quot;&gt;vi ~/.zshrc&lt;/code&gt;, что вам удобнее. Открываем данный файл на редактирование и ищем строку &lt;code class=&quot;highlighter-rouge&quot;&gt;plugins=(git)&lt;/code&gt; и добавляем туда все нужные нам плагины, учитывая список выше, вышло следующее: &lt;code class=&quot;highlighter-rouge&quot;&gt;plugins=(git npm vagrant composer sudo web-search)&lt;/code&gt;. После изменения данного файла, &lt;strong&gt;всегда&lt;/strong&gt; необходимо прописывать &lt;code class=&quot;highlighter-rouge&quot;&gt;source ~/.zshrc&lt;/code&gt;, иначе изменения вступят в силу только после перезагрузки.&lt;/p&gt;

&lt;h2 id=&quot;Установка-тем-оформления&quot;&gt;Установка тем оформления&lt;/h2&gt;

&lt;p&gt;Из коробки оформление Zsh кому-то может и приглянуться, но мне оно не зашло. Называется она &lt;code class=&quot;highlighter-rouge&quot;&gt;robbyrussell&lt;/code&gt;. Но есть куча других тем, по ссылке &lt;a href=&quot;https://github.com/robbyrussell/oh-my-zsh/wiki/themes&quot;&gt;полный список тем&lt;/a&gt; которые идут в комплекте Oh My Zsh.&lt;/p&gt;

&lt;p&gt;Я покажу как включать темы на примере оформления &lt;strong&gt;agnoster&lt;/strong&gt;, так как оно больше всего мне по душе и иногда также требует дополнительных действий для корректной работы.&lt;/p&gt;

&lt;p&gt;Для включеня данной темы нам опять, достаточно открыть &lt;code class=&quot;highlighter-rouge&quot;&gt;~/.zshrc&lt;/code&gt; файли найти строку &lt;code class=&quot;highlighter-rouge&quot;&gt;ZSH_THEME=&quot;robbyrussell&quot;&lt;/code&gt; и заменить стандартную тему на нужную, в моем случае &lt;code class=&quot;highlighter-rouge&quot;&gt;agnoster&lt;/code&gt;, итого получается &lt;code class=&quot;highlighter-rouge&quot;&gt;ZSH_THEME=&quot;agnoster&quot;&lt;/code&gt;. Не забываем про &lt;code class=&quot;highlighter-rouge&quot;&gt;source ~/.zshrc&lt;/code&gt;. И всё уже работает!&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/assets/images/linux/oh-my-zsh/oh-my-zsh-03.png&quot;&gt;&lt;img src=&quot;/assets/images/linux/oh-my-zsh/oh-my-zsh-03.png&quot; alt=&quot;Установленая тема: agnoster&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Если у вас вместо иконок Git или нету “уголков” в строке навигации, то вам нужно поставить спец. шрифты с данными иконками. Множество тем требует установки данных шрифтов, они никак не помешают, но будет работать как нужно. Если всё как и на скринах - ставить не нужно, если же нет, то ниже инструкция для вас.&lt;/p&gt;

&lt;p&gt;Давайте установим &lt;a href=&quot;https://github.com/powerline/fonts&quot;&gt;пропатченные шрифты&lt;/a&gt;:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;# clone&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git clone https://github.com/powerline/fonts.git&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;span class=&quot;c&quot;&gt;# install&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;fonts&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;./install.sh&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;span class=&quot;c&quot;&gt;# clean-up a bit&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; ..&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;rm &lt;span class=&quot;nt&quot;&gt;-rf&lt;/span&gt; fonts&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Этого уже будет достаточно, можно работать. Но некоторые моменты я ещё затрону.&lt;/p&gt;

&lt;h2 id=&quot;Настройки&quot;&gt;Настройки&lt;/h2&gt;

&lt;p&gt;Я их не правлю, но выписал с обьяснением чтобы было проще ориентироваться. Напоминаю что все они в &lt;code class=&quot;highlighter-rouge&quot;&gt;~/.zshrc&lt;/code&gt;. Если настройка закомментирована, то вы можете расскоментировать её удалив &lt;code class=&quot;highlighter-rouge&quot;&gt;#&lt;/code&gt;, то что указано в значении которое закомментировано - является противоположным значению по умолчанию.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;CASE_SENSITIVE=”true”&lt;/strong&gt; — чуствительность к регистру. Как я указал в начале статьи, он сам может исправлять регистр если видит что в текущем ничего не найдено. Если это мешает, установив данный параметр в true, поведение будет привычное bash;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;HYPHEN_INSENSITIVE=”true”&lt;/strong&gt; — включает автоматическую замену между “_” и “-“. Аналогично параметру выше, но касается только дефиса и подчеркивания;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;DISABLE_AUTO_UPDATE=”true”&lt;/strong&gt; — позволяет отключить автоматическое обновления Oh My Zsh;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;export UPDATE_ZSH_DAYS=13&lt;/strong&gt; — задает переодично проверки обновлений;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;DISABLE_LS_COLORS=”true”&lt;/strong&gt; — позволяте отключить цветовую палитру при выводе команды &lt;code class=&quot;highlighter-rouge&quot;&gt;ls&lt;/code&gt;;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;DISABLE_AUTO_TITLE=”true”&lt;/strong&gt; — отключение автоматического заголовка терминала;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ENABLE_CORRECTION=”true”&lt;/strong&gt; — включает корректировку команд. Например, вводя &lt;code class=&quot;highlighter-rouge&quot;&gt;compozer&lt;/code&gt; он выдаст запрос: &lt;code class=&quot;highlighter-rouge&quot;&gt;correct 'compozer' to 'composer'?&lt;/code&gt;;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;COMPLETION_WAITING_DOTS=”true”&lt;/strong&gt; — включает точки ожидания ввода аргументов. Например введя &lt;code class=&quot;highlighter-rouge&quot;&gt;composer&lt;/code&gt; и нажав &lt;code class=&quot;highlighter-rouge&quot;&gt;Tab&lt;/code&gt;, он будет перебирать доступные команды (из-за одноименного плагина), а если ввести &lt;code class=&quot;highlighter-rouge&quot;&gt;java&lt;/code&gt; и нажать таб, у него нет вариантов автодополнения (они будут появляться по мере их успешнного ввода в терминале и кэшироваться) он будет отображать красные точки для обязательного ввода которые можно отменить только &lt;kbd&gt;Ctrl + C&lt;/kbd&gt;;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;DISABLE_UNTRACKED_FILES_DIRTY=”true”&lt;/strong&gt; — отключает пометку неиспользуемых файлов в пределе Git репозитория как “гразных”, что увеличивает скорость скана для git. Не могу сказать точнее что это и как это работает, но это напрямую связанно с git вообще, а не только плагином;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;HIST_STAMPS=”mm/dd/yyyy”&lt;/strong&gt; — позволяет менять формат даты для команды &lt;code class=&quot;highlighter-rouge&quot;&gt;history&lt;/code&gt;;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ZSH_CUSTOM=/path/to/new-custom-folder&lt;/strong&gt; — позволяет добавить дополнительный путь до папки где будут храниться кастомные плагины и темы. По дефолту &lt;code class=&quot;highlighter-rouge&quot;&gt;~/.oh-my-zsh/custom&lt;/code&gt;, она также будет функционаривать, т.е. параметр не перезатерающийся.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;Фиксим-проблему-с-path&quot;&gt;Фиксим проблему с PATH&lt;/h2&gt;

&lt;p&gt;В Linux (не знаю как в MacOS), и в текущей версии я такой проблемы не словил, есть или можеть быть проблема что вы вбиваете команду в Zsh, а он говорит её нет. И это нормальное поведение, ведь в момент установки у вас был другой шелл, и возможно путь до бинарника указан в его индивидуальных настройках. Чтобы это исправить, достаточно указать путь до папки с бинарником(ами) в PATH переменную системы. Но bash’овский вариант &lt;code class=&quot;highlighter-rouge&quot;&gt;export PATH=/usr/local/bin:$PATH&lt;/code&gt; прокатит до перезагрузки.&lt;/p&gt;

&lt;p&gt;Вариант первый, это в файле конфига &lt;code class=&quot;highlighter-rouge&quot;&gt;~/.zshrc&lt;/code&gt; раскомментировать соответсвующую строку в самом начале и добавить нужные пути, либо добавить их прямо из терминала:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;# Добавить в конец переменной&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;path+&lt;span class=&quot;o&quot;&gt;=(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'/home/USERNAME/SOMEPATH/bin'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;span class=&quot;c&quot;&gt;# Добавить в начало переменной&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;span class=&quot;nv&quot;&gt;$ path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'/home/USERNAME/SOMEPATH/bin'&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;span class=&quot;c&quot;&gt;# Отгрузить новую переменную&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;PATH&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;Удаляем-oh-my-zsh&quot;&gt;Удаляем Oh My Zsh&lt;/h2&gt;

&lt;p&gt;Если вам потребуется полностью удалить Oh My Zsh и сам шелл с системы, то это делается достаточно просто:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;# Удаляем Oh My Zsh и всё что с ним связано&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;uninstall_oh_my_zsh&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;span class=&quot;c&quot;&gt;# Удаляем Zsh&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;apt uninstall zsh&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;</content><author><name>niklan.net</name></author><category term="linux" /><summary type="html">Хочу поделиться очень отличным шелом, а по большей части, фреймворком созданным для него, который превратит вашу консоль в очень информативный и продуктивный инструмент.</summary></entry><entry><title type="html">Как ускорить gzip сжатие?</title><link href="https://denisnovikov.github.io/blog/how-to-speed-up-gzip-compression/" rel="alternate" type="text/html" title="Как ускорить gzip сжатие?" /><published>2017-04-25T12:44:27+03:00</published><updated>2017-04-25T12:44:27+03:00</updated><id>https://denisnovikov.github.io/blog/how-to-speed-up-gzip-compression</id><content type="html" xml:base="https://denisnovikov.github.io/blog/how-to-speed-up-gzip-compression/">&lt;p&gt;Когда нужно сжимать большие объемы текста на мощном железе, gzip может работать не так эффективно, как хотелось бы. Gzip работает в 1 поток и эффективно будет использовать только одно ядро.&lt;/p&gt;

&lt;p&gt;Есть несколько альтернативных утилит, которые сжимают файлы используя все ядра. Одна из них — &lt;a href=&quot;http://zlib.net/pigz/&quot;&gt;pigz&lt;/a&gt;. Установить ее можно из пакетов:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;apt-get install pigz&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Для сравнения мы взяли текстовый файл на &lt;code class=&quot;highlighter-rouge&quot;&gt;4.6Гб&lt;/code&gt; и запускали оба архиватора на 8-ядерном сервере:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;# Обычный gzip&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;gzip test.txt&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;...&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;span class=&quot;k&quot;&gt;done in &lt;/span&gt;25.1s&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;# Многопоточный pigz&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;pigz test.txt&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;...&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;span class=&quot;k&quot;&gt;done in &lt;/span&gt;7.5s&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;blockquote&gt;
  &lt;p&gt;pigz отработал &lt;strong&gt;в 4&lt;/strong&gt; раза быстрее&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Есть и &lt;a href=&quot;https://github.com/klauspost/pgzip&quot;&gt;другие инструменты сжатия&lt;/a&gt;, которые используют современные процессоры намного эффективнее стандартного gzip’a.&lt;/p&gt;</content><author><name>ruhighload.com</name></author><category term="linux" /><summary type="html">Когда нужно сжимать большие объемы текста на мощном железе, gzip может работать не так эффективно, как хотелось бы. Gzip работает в 1 поток и эффективно будет использовать только одно ядро.</summary></entry><entry><title type="html">Как обновить крон без запуска текстового редактора</title><link href="https://denisnovikov.github.io/blog/how-to-update-czk-without-starting-a-text-editor/" rel="alternate" type="text/html" title="Как обновить крон без запуска текстового редактора" /><published>2017-04-05T09:47:36+03:00</published><updated>2017-04-05T09:47:36+03:00</updated><id>https://denisnovikov.github.io/blog/how-to-update-czk-without-starting-a-text-editor</id><content type="html" xml:base="https://denisnovikov.github.io/blog/how-to-update-czk-without-starting-a-text-editor/">&lt;p&gt;Всем знают, что можно сделать так:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;crontab &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;После выполнения команды запустится любимый nano/vi/mcedit, в котором можно отредактировать расписание, и после закрытия редактора файл расписания будет обновлен.&lt;/p&gt;

&lt;p&gt;Но бывают ситуации, когда расписания нужно обновлять автоматически с помощью скриптов, например, в условиях continuous integration или проектов, в которых расписание задает пользователь.&lt;/p&gt;

&lt;h2 id=&quot;Используем-etccrond&quot;&gt;Используем /etc/cron.d&lt;/h2&gt;

&lt;p&gt;Такие расписания можно раскладывать по файлам, для которых есть специальная папка:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; /etc/cron.d&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;php&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;В эту папку можно добавлять свои сценарии, разбивая их для удобства на файлы(файлов может быть много). Единственное, чем отличаются сценарии в файле это тем, что перед командой нужно указать пользователя, от имени которого эта команда будет выполнена, например:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;/10 &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; www-data /var/www/task/flush_cache.sh&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;С помощью такого подхода расписание кронтаба можно хранить в коде проекта и при деплое обновлять кронтаб автоматически, запустив одну простую команду:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /var/www/my_project/conf/crontab &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /etc/cron.d/my_project&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;Важно-помнить&quot;&gt;Важно помнить&lt;/h2&gt;

&lt;p&gt;Не забывайте, что в конце каждого кронтаба должна быть пустая строка, иначе расписание не запустится.&lt;/p&gt;</content><author><name>ruhighload.com</name></author><category term="linux" /><summary type="html">Всем знают, что можно сделать так:</summary></entry><entry><title type="html">Как удалить миллион файлов</title><link href="https://denisnovikov.github.io/blog/how-to-delete-million-of-files/" rel="alternate" type="text/html" title="Как удалить миллион файлов" /><published>2017-03-28T11:40:19+03:00</published><updated>2017-03-28T11:40:19+03:00</updated><id>https://denisnovikov.github.io/blog/how-to-delete-million-of-files</id><content type="html" xml:base="https://denisnovikov.github.io/blog/how-to-delete-million-of-files/">&lt;p&gt;На серверах могут скапливаться горы файлов, которые периодически нужно удалять. Например, логи, скомпилированные версии файлов, или любой другой файловый кеш, генерируемый скриптами.&lt;/p&gt;

&lt;p&gt;Рано или поздно эти горы приходится вычищать:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;rm /tmp/logs/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;.log&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Если количество файлов будет критично большим, в какой-то момент вместо удаления файлов мы увидим такое сообщение в консоли:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;/bin/rm: Argument list too long.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Что это означает?&lt;/p&gt;

&lt;h2 id=&quot;Проблема&quot;&gt;Проблема&lt;/h2&gt;

&lt;p&gt;Дело в том, что использование маски в командах типа rm/cp/find линукс переводит в удобный для себя формат, делая из понятной человеку команде:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;rm /tmp/logs/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;.log&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;список файлов под этой маской:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;rm /tmp/logs/1.log /tmp/logs/2.log /tmp/logs/3.log ...&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Проблемы начинаются, когда аргументов у команды rm становится больше допустимого лимита. Проверить этот лимит можно с помощью команды getconf:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;getconf ARG_MAX&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;262144&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;И что все-таки делать?&lt;/p&gt;

&lt;h2 id=&quot;Использовать-цикл-for&quot;&gt;Использовать цикл For&lt;/h2&gt;

&lt;p&gt;Самый простой способ — выполнить нужную нам команду в цикле for, у которого есть два важных преимущества. Во-первых, циклы нересурсоемкие и не имеют лимитов на количество аргументов. Во-вторых, в цикл просто завернуть дополнительную логику, если потребуется делать что-то сложнее, чем удаление файлов.&lt;/p&gt;

&lt;p&gt;Например, вот так можно удалить все файлы одной командой:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;f &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; /tmp/logs/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;.log&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do &lt;/span&gt;rm &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Или удалить файлы, которые старше семи дней:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;f &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; /tmp/logs/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;.log&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;span class=&quot;k&quot;&gt;do&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;  &lt;/span&gt;find &lt;span class=&quot;nv&quot;&gt;$f&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-mtime&lt;/span&gt; +7 &lt;span class=&quot;nt&quot;&gt;-exec&lt;/span&gt; rm &lt;span class=&quot;o&quot;&gt;{}&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\;&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Или посчитать, записать в переменную и вывести их количество:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;FILES_COUNT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;f &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; /tmp/logs/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;.log &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;c++&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$c&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;br data-jekyll-commonmark-ghpages=&quot;&quot; /&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$FILES_COUNT&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; log files left&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;Самое-главное&quot;&gt;Самое главное&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;не забывайте чистить логи регулярно, чтобы не засорять файловую систему;&lt;/li&gt;
  &lt;li&gt;используйте для этого готовые инструменты, чтобы не придумывать свои велосипеды;&lt;/li&gt;
  &lt;li&gt;перечитывайте команды перед выполнением, чтобы случайно не удалить всё.&lt;/li&gt;
&lt;/ul&gt;</content><author><name>ruhighload.com</name></author><category term="linux" /><summary type="html">На серверах могут скапливаться горы файлов, которые периодически нужно удалять. Например, логи, скомпилированные версии файлов, или любой другой файловый кеш, генерируемый скриптами.</summary></entry></feed>