<!DOCTYPE html><html lang="ru"><head>  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-89748707-1"></script> <script> window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'UA-89748707-1'); </script><base href="https://denisnovikov.github.io"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="google-site-verification" content="aiV-7fBXdNhcJILKp5GXFesXJetzCgLWAbif-tZKfrY" /><meta name="yandex-verification" content="41a2ad868168b23f" /><meta name="openstat-verification" content="62f671b1eaa0d2a7ce234219685a42b3d7770961" /><meta property="op:markup_version" content="v1.0"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="application-name" content="FrontEnd Blog"><meta name="format-detection" content="telephone=no"><meta name="generator" content="jekyll"><meta name="google" content="notranslate"><meta name="rating" content="General"><meta name="referrer" content="never"><meta name="robots" content="index,follow,noodp"><meta name="subject" content="blog"><meta name="url" content="https://denisnovikov.github.io"><meta name="viewport" content="width=device-width, initial-scale=1"><title> Краткая запись CSS как антипаттерн - denisnovikov.github.io</title><meta name="description" content="Существует небольшая, но на удивление важная (и, что более удивительно, распространенная) проблема, которую я часто замечал в коде других людей, как непосред..."><link rel="alternate" hreflang="ru" href="/blog/a-brief-record-of-how-css-anti-pattern/" /><link rel="canonical" href="https://denisnovikov.github.io/blog/a-brief-record-of-how-css-anti-pattern/"><link rel="author" href="DNovikov"><link rel="me" href="https://github.com/denisnovikov" type="text/html"><link rel="me" href="mailto:dnovikov1808@gmail.com"><link href='https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|Roboto+Condensed:700&subset=latin' rel='stylesheet' type='text/css'><link rel="stylesheet" href="/assets/css/main.css"><meta property="og:url" content="https://denisnovikov.github.io/blog/a-brief-record-of-how-css-anti-pattern/"><meta property="og:type" content="website"><meta property="og:title" content="Краткая запись CSS как антипаттерн"><meta property="og:description" content="Существует небольшая, но на удивление важная (и, что более удивительно, распространенная) проблема, которую я часто замечал в коде других людей"><meta property="og:site_name" content="denisnovikov.github.io"><meta property="og:locale" content="ru_RU"><meta property="article:author" content="DNovikov"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@dev_novikov"><meta name="twitter:creator" content="@dev_novikov"><meta name="twitter:url" content="https://denisnovikov.github.io/blog/a-brief-record-of-how-css-anti-pattern/"><meta name="twitter:title" content="Краткая запись CSS как антипаттерн"><meta name="twitter:description" content="Существует небольшая, но на удивление важная (и, что более удивительно, распространенная) проблема, которую я часто замечал в коде других людей"><meta property="og:image" content="https://denisnovikov.github.io/assets/images/bg.svg"><meta name="twitter:image" content="https://denisnovikov.github.io/assets/images/bg.svg"><body><div id="shadow"></div><header class="main-header content-wrapper"> <input type="checkbox" id="menu-checkbox" /><nav class="center-wrapper nav-main"> <a class="blog-logo" href="/">denisnovikov.github.io</a> <a href="/about/">О проекте</a> <a href="/blog/">Все записи блога</a> <a href="/feed.xml" rel="alternate" type="application/rss+xml">RSS</a> <label for="menu-checkbox" class="toggle-button" data-open="☰" data-close="☰" onclick></label></nav></header><aside class="sidebar" role="note" style=" background-image: url( /assets/images/front-end/a-brief-record-of-how-css-anti-pattern/preview-a-brief-record-of-how-css-anti-pattern.jpg )"><div class="cover"><div class="cover-text"><div class="heading"> <a href="/blog/#front-end">front-end</a></div><p> Существует небольшая, но на удивление важная (и, что более удивительно, распространенная) проблема, которую я часто замечал в коде других людей Краткая запись CSS как антипаттерн</div></div><div id="switcher"></div></aside><main class="content-wrapper"><article class="post"><h1 class="post-title">Краткая запись CSS как антипаттерн</h1><p class="post-meta"> <time datetime="2016-12-12">12-12-2016</time> &nbsp;/&nbsp; <span>awdee.ru</span><div class="post-content"><p>Существует небольшая, но на удивление важная (и, что более удивительно, распространенная) проблема, которую я часто замечал в коде других людей, как непосредственно работая с ним, так и в ходе рефакторинга или аудита кода — это использование краткой записи свойств CSS.<p>Обычно мы рассматриваем краткий синтаксис как преимущество: меньше нажатий на клавиатуру, меньше строчек кода и меньше данных, передаваемых по сети. Отлично же! Однако, здесь есть неприятный побочный эффект: <strong>таким образом мы зачастую сбрасываем значения свойств, которые изначально не собирались модифицировать</strong>.<p>Когда мы пишем что-то вроде этого:<figure class="highlight"><pre><code class="language-css" data-lang="css"><span class="nc">.btn</span> <span class="p">{</span><br data-jekyll-commonmark-ghpages="" />  <span class="nl">background</span><span class="p">:</span> <span class="no">red</span><span class="p">;</span><br data-jekyll-commonmark-ghpages="" /><span class="p">}</span></code></pre></figure><p>Мы всего лишь хотим, чтобы у нашей кнопки был красный фоновый цвет. Но на самом деле мы задаем целый набор правил:<figure class="highlight"><pre><code class="language-css" data-lang="css"><span class="nc">.btn</span> <span class="p">{</span><br data-jekyll-commonmark-ghpages="" />  <span class="nl">background-image</span><span class="p">:</span> <span class="n">initial</span><span class="p">;</span><br data-jekyll-commonmark-ghpages="" />  <span class="py">background-position-x</span><span class="p">:</span> <span class="n">initial</span><span class="p">;</span><br data-jekyll-commonmark-ghpages="" />  <span class="py">background-position-y</span><span class="p">:</span> <span class="n">initial</span><span class="p">;</span><br data-jekyll-commonmark-ghpages="" />  <span class="nl">background-size</span><span class="p">:</span> <span class="n">initial</span><span class="p">;</span><br data-jekyll-commonmark-ghpages="" />  <span class="py">background-repeat-x</span><span class="p">:</span> <span class="n">initial</span><span class="p">;</span><br data-jekyll-commonmark-ghpages="" />  <span class="py">background-repeat-y</span><span class="p">:</span> <span class="n">initial</span><span class="p">;</span><br data-jekyll-commonmark-ghpages="" />  <span class="nl">background-attachment</span><span class="p">:</span> <span class="n">initial</span><span class="p">;</span><br data-jekyll-commonmark-ghpages="" />  <span class="nl">background-origin</span><span class="p">:</span> <span class="n">initial</span><span class="p">;</span><br data-jekyll-commonmark-ghpages="" />  <span class="nl">background-clip</span><span class="p">:</span> <span class="n">initial</span><span class="p">;</span><br data-jekyll-commonmark-ghpages="" />  <span class="nl">background-color</span><span class="p">:</span> <span class="no">red</span><span class="p">;</span><br data-jekyll-commonmark-ghpages="" /><span class="p">}</span></code></pre></figure><p>За счет простого использования краткой записи, мы безоговорочно решили, что не хотим использовать фоновое изображение, заодно указав для него стартовую позицию с левого верхнего края, повторение по осям <code class="highlighter-rouge">x</code> и <code class="highlighter-rouge">y</code> и прокрутку вместе с элементом и т.д.<p>Почти все проблемы, баги и регрессии в CSS происходят из-за того, что мы делаем слишком многое слишком рано, а через некоторое время сталкиваемся с последствиями этого. Из этого факта следует один простой вывод: <strong>в CSS вам нужно делать лишь то, что нужно и ничего более</strong>.<p>Неправильное использование краткой записи это прямой путь к тому, чтобы делать слишком многое слишком рано и поэтому его необходимо избегать. Отменять CSS намного сложнее, чем добавлять.<p>В нашем примере мы хотели сделать следующее:<figure class="highlight"><pre><code class="language-css" data-lang="css"><span class="nc">.btn</span> <span class="p">{</span><br data-jekyll-commonmark-ghpages="" />  <span class="nl">background-color</span><span class="p">:</span> <span class="no">red</span><span class="p">;</span><br data-jekyll-commonmark-ghpages="" /><span class="p">}</span></code></pre></figure><p>И в этом коде мы делаем именно то, что нужно и ничего более.<p>В этом году я столкнулся с одним подобным примером на клиентском проекте:<figure class="highlight"><pre><code class="language-css" data-lang="css"><span class="nc">.base-class</span> <span class="p">{</span><br data-jekyll-commonmark-ghpages="" />  <span class="nl">background-position</span><span class="p">:</span> <span class="m">0</span> <span class="m">0</span><span class="p">;</span><br data-jekyll-commonmark-ghpages="" />  <span class="nl">background-repeat</span><span class="p">:</span> <span class="nb">no-repeat</span><span class="p">;</span><br data-jekyll-commonmark-ghpages="" /><span class="p">}</span><br data-jekyll-commonmark-ghpages="" /><br data-jekyll-commonmark-ghpages="" /><span class="nc">.base-class--modifier</span> <span class="p">{</span><br data-jekyll-commonmark-ghpages="" />  <span class="nl">background</span><span class="p">:</span> <span class="n">radial-gradient</span><span class="p">(...)</span><br data-jekyll-commonmark-ghpages="" /><span class="p">}</span></code></pre></figure><p>Разработчик использовал (и это понятно) синтаксис генератора градиентов для создания сложного радиального градиента, но при этом получилось так, что рендеринг всего вышел совершенно неправильный. Синтаксис градиентов правильный, автопрефиксер работал отлично, но по какой-то причине страница выглядела поломанной.<p>Команда не смогла разобраться с проблемой, в качестве выхода было предложено “пригласить Гарри, чтобы он разобрался с градиентом” (Гарри Робертс это автор статьи — <em>прим. пер.</em>). Годы опыта в качестве разработчика инстинктивно показали мне, где искать и я нашел: причиной была спрятанная в генераторе градиентов Sass краткая запись свойства <code class="highlighter-rouge">background</code>.<p>Эта проблема является традиционной для генераторов градиентов, поэтому:<ol><li>Обновите свой генератор градиентов прямо сейчас;<li>Отправьте пулл-реквест во все проекты, где используется краткая запись;<li>Проверьте весь код, который вы скопировали из онлайн-генераторов градиентов.</ol><p>Пример с <code class="highlighter-rouge">background</code> это лишь один из множества случаев, когда нам не стоит использовать краткую запись. Не менее распространено вертикальное центрирование с помощью <code class="highlighter-rouge">margin: 0 auto;</code>:<figure class="highlight"><pre><code class="language-css" data-lang="css"><span class="nc">.wrapper</span> <span class="p">{</span><br data-jekyll-commonmark-ghpages="" />  <span class="nl">margin</span><span class="p">:</span> <span class="m">0</span> <span class="nb">auto</span><span class="p">;</span><br data-jekyll-commonmark-ghpages="" /><span class="p">}</span></code></pre></figure><p>Проблема здесь в том, что при использовании краткой записи мы указываем auto один раз и это значение используется дважды (справа и слева), а, значит, нам также надо определиться и насчет отступов сверху и снизу. Краткая запись принудила нас к необязательному в обычных условиях решению — явно удалить отступы снизу и сверху, которые вы могли ранее задать в каком-либо другом месте.<p>Если вам нужно всего лишь центрировать блок, то не стоит при этом трогать верхний и нижний отступы — обычная запись здесь выигрывает:<figure class="highlight"><pre><code class="language-css" data-lang="css"><span class="nc">.wrapper</span> <span class="p">{</span><br data-jekyll-commonmark-ghpages="" />  <span class="nl">margin-right</span><span class="p">:</span> <span class="nb">auto</span><span class="p">;</span><br data-jekyll-commonmark-ghpages="" />  <span class="nl">margin-left</span><span class="p">:</span>  <span class="nb">auto</span><span class="p">;</span><br data-jekyll-commonmark-ghpages="" /><span class="p">}</span></code></pre></figure><p>Поищите в стилях вашего проекта 0 auto прямо сейчас и посмотрите, что вы найдете.<h2 id="Исключения">Исключения</h2><p>До сих пор мы рассматривали проблему случайного сброса других свойств, но есть случаи, когда этот сценарий работает нормально. Например:<figure class="highlight"><pre><code class="language-css" data-lang="css"><span class="nc">.box</span> <span class="p">{</span><br data-jekyll-commonmark-ghpages="" />  <span class="nl">padding</span><span class="p">:</span> <span class="m">10px</span><span class="p">;</span><br data-jekyll-commonmark-ghpages="" /><span class="p">}</span></code></pre></figure><p>Здесь мы ничего случайно не сбрасываем, так как сознательно делаем внутренний отступ в 10 пикселей со всех сторон. И в этом случае краткая запись полностью осмысленна. То же относится и к этой записи:<figure class="highlight"><pre><code class="language-css" data-lang="css"><span class="nc">.btn</span> <span class="p">{</span><br data-jekyll-commonmark-ghpages="" />  <span class="nl">padding</span><span class="p">:</span> <span class="m">12px</span> <span class="m">24px</span><span class="p">;</span><br data-jekyll-commonmark-ghpages="" /><span class="p">}</span></code></pre></figure><p>И к этой:<figure class="highlight"><pre><code class="language-css" data-lang="css"><span class="nc">.foo</span> <span class="p">{</span><br data-jekyll-commonmark-ghpages="" />  <span class="nl">margin</span><span class="p">:</span> <span class="m">12px</span> <span class="m">17px</span> <span class="m">16px</span> <span class="m">10px</span><span class="p">;</span><br data-jekyll-commonmark-ghpages="" /><span class="p">}</span></code></pre></figure><p>В этом случае мы по-прежнему явно задаем все четыре расстояния (хотя стоит спросить о смысле <a href="http://csswizardry.com/2012/11/code-smells-in-css/#magic-numbers">магических чисел</a>), но сама краткая запись в полном порядке.<p>И это главное, что нужно помнить: краткая запись плоха, когда влияет на свойства, которые на самом деле вам не нужно модифицировать.<p>Этот вид действий — ненамеренный сброс других свойств — особенно проблематичен в модульных и компонуемых системах, когда множество различных классов могут быть использованы в сочетании друг с другом для формирования более сложных композитов. Элементы кода, которые нельзя соединить без коллизий являются неортогональными, а ортогональность это важный принцип архитектуры программного обеспечения.<ul><li><strong>Всегда предпочитайте полную запись</strong>. Это потребует большего количества нажатий на клавиатуру, большего количества повторений, но это более аккуратно;<li><strong>Пишите ровно столько правил, сколько надо и не больше</strong>. Большинство проблем в CSS являются следствием слишком широкого применения правил — избегайте этого.</ul><p align="right"><small><em>Источник: http://prgssr.ru/development/kratkaya-zapis-css-kak-antipattern.html</em></small><div class="post-links"> <a class="link-to-post" href="/blog/display-previously-entered-user-lightdm/"> <span class="link-to-post__next">&#10535; &nbsp;Next post</span> <span class="link-to-post__title">Отображение ранее введенного пользователя в lightdm</span> </a> <a class="link-to-post" href="/blog/why-dont-trust-cases/"> <span class="link-to-post__prev">&#10535; &nbsp;Previous post</span> <span class="link-to-post__title">Почему не стоит слишком доверять кейсам?</span> </a></div></div></article></main><footer class="blog-footer content-wrapper"><p>&copy; <span class="full-year"></span> denisnovikov.github.io</footer><script src="/assets/js/scripts.js"></script>  <script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function () { try { w.yaCounter45975960 = new Ya.Metrika({ id: 45975960, clickmap: true, trackLinks: true, accurateTrackBounce: true, webvisor: true }); } catch (e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks"); </script> <noscript><div> <img src="https://mc.yandex.ru/watch/45975960" style="position:absolute; left:-9999px;" alt="" /></div></noscript>  <!--Openstat--> <span id="openstat1"></span> <script type="text/javascript"> var openstat = { counter: 1, next: openstat }; (function(d, t, p) { var j = d.createElement(t); j.async = true; j.type = "text/javascript"; j.src = ("https:" == p ? "https:" : "http:") + "//openstat.net/cnt.js"; var s = d.getElementsByTagName(t)[0]; s.parentNode.insertBefore(j, s); })(document, "script", document.location.protocol); </script> <!--/Openstat-->
