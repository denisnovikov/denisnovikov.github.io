<!DOCTYPE html><html lang="ru"><head>  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-89748707-1"></script> <script> window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'UA-89748707-1'); </script><base href="https://denisnovikov.github.io"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="google-site-verification" content="aiV-7fBXdNhcJILKp5GXFesXJetzCgLWAbif-tZKfrY" /><meta name="yandex-verification" content="41a2ad868168b23f" /><meta name="openstat-verification" content="62f671b1eaa0d2a7ce234219685a42b3d7770961" /><meta property="op:markup_version" content="v1.0"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="application-name" content="FrontEnd Blog"><meta name="format-detection" content="telephone=no"><meta name="generator" content="jekyll"><meta name="google" content="notranslate"><meta name="rating" content="General"><meta name="referrer" content="never"><meta name="robots" content="index,follow,noodp"><meta name="subject" content="blog"><meta name="url" content="https://denisnovikov.github.io"><meta name="viewport" content="width=device-width, initial-scale=1"><title> Open Graph разметка в 1С-Битрикс - denisnovikov.github.io</title><meta name="description" content="Open Graph — это стандарт метатегов, разработанный соц.сетью Facebook для передачи информации различным сервисам о содержании страницы."><link rel="alternate" hreflang="ru" href="/blog/open-graph-markup-to-1c-bitrix/" /><link rel="canonical" href="https://denisnovikov.github.io/blog/open-graph-markup-to-1c-bitrix/"><link rel="author" href="DNovikov"><link rel="me" href="https://github.com/denisnovikov" type="text/html"><link rel="me" href="mailto:dnovikov1808@gmail.com"><link href='https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|Roboto+Condensed:700&subset=latin' rel='stylesheet' type='text/css'><link rel="stylesheet" href="/assets/css/main.css"><meta property="og:url" content="https://denisnovikov.github.io/blog/open-graph-markup-to-1c-bitrix/"><meta property="og:type" content="website"><meta property="og:title" content="Open Graph разметка в 1С-Битрикс"><meta property="og:description" content="Open Graph — это стандарт метатегов, разработанный соц.сетью Facebook для передачи информации различным сервисам о содержании страницы."><meta property="og:site_name" content="denisnovikov.github.io"><meta property="og:locale" content="ru_RU"><meta property="article:author" content="DNovikov"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@dev_novikov"><meta name="twitter:creator" content="@dev_novikov"><meta name="twitter:url" content="https://denisnovikov.github.io/blog/open-graph-markup-to-1c-bitrix/"><meta name="twitter:title" content="Open Graph разметка в 1С-Битрикс"><meta name="twitter:description" content="Open Graph — это стандарт метатегов, разработанный соц.сетью Facebook для передачи информации различным сервисам о содержании страницы."><meta property="og:image" content="https://denisnovikov.github.io/assets/images/bg.svg"><meta name="twitter:image" content="https://denisnovikov.github.io/assets/images/bg.svg"><body><div id="shadow"></div><header class="main-header content-wrapper"> <input type="checkbox" id="menu-checkbox" /><nav class="center-wrapper nav-main"> <a class="blog-logo" href="/">denisnovikov.github.io</a> <a href="/about/">О проекте</a> <a href="/blog/">Все записи блога</a> <a href="/feed.xml" rel="alternate" type="application/rss+xml">RSS</a> <label for="menu-checkbox" class="toggle-button" data-open="☰" data-close="☰" onclick></label></nav></header><aside class="sidebar" role="note" style=" background-image: url( /assets/images/pages/bg.svg)"><div class="cover"><div class="cover-text"><div class="heading"> <a href="/blog/#bitrix">bitrix</a></div><p> Open Graph — это стандарт метатегов, разработанный соц.сетью Facebook для передачи информации различным сервисам о содержании страницы. Open Graph разметка в 1С-Битрикс</div></div><div id="switcher"></div></aside><main class="content-wrapper"><article class="post"><h1 class="post-title">Open Graph разметка в 1С-Битрикс</h1><p class="post-meta"> <time datetime="2017-09-22">22-09-2017</time> &nbsp;/&nbsp; <span>keengo.ru</span><div class="post-content"><p>Open Graph — это стандарт метатегов, разработанный соц.сетью Facebook для передачи информации различным сервисам о содержании страницы.<p>Стандартной разметкой Open Graph пользуется большинство популярных социальных сетей Facebook, Вконтакте, Google+, Twitter, LinkedIn, Pinterest и другие.<p>Данные добавляются в секцию &lt;head&gt; в виде метатегов:<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;meta</span> <span class="na">property=</span><span class="s">"og:url"</span> <span class="na">content=</span><span class="s">"https://keengo.ru"</span><span class="nt">&gt;</span></code></pre></figure><p>В качестве свойств данной разметкой могут передаваться следующие параметры:<ul><li><strong>og:url</strong> — ссылка на страницу<li><strong>og:type</strong> — тип передаваемого объекта<li><strong>og:title</strong> — заголовок страницы или объекта<li><strong>og:description</strong> — описание страницы или объекта<li><strong>og:image</strong> — превью изображение</ul><p>Как же добавить данные параметры в шапку шаблона 1С-Битрикс, чтобы они автоматически отображали информацию текущей страницы, которой делится в соц.сети пользователь?<p>Для начала определим некоторые параметры, которые так же пригодятся для дальнейшего использования на сайте, в самом начале файла header.php вашей темы добавляем код:<figure class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?</span><br data-jekyll-commonmark-ghpages="" /><span class="nb">define</span><span class="p">(</span><span class="s2">"SITE_SERVER_PROTOCOL"</span><span class="p">,</span> <span class="p">(</span><span class="nx">CMain</span><span class="o">::</span><span class="na">IsHTTPS</span><span class="p">())</span> <span class="o">?</span> <span class="s2">"https://"</span> <span class="o">:</span> <span class="s2">"http://"</span><span class="p">);</span> <span class="c1">// Переменная определяет протокол, по которому работает ваш сайт<br data-jekyll-commonmark-ghpages="" /></span><span class="nv">$curPage</span> <span class="o">=</span> <span class="nv">$APPLICATION</span><span class="o">-&gt;</span><span class="na">GetCurPage</span><span class="p">();</span> <span class="c1">// Получаем текущий адрес страницы<br data-jekyll-commonmark-ghpages="" /></span><span class="cp">?&gt;</span></code></pre></figure><p>Затем в секции &lt;head&gt; добавляем наши метатеги с параметрами для вывода Open Graph разметки:<figure class="highlight"><pre><code class="language-php" data-lang="php"><span class="nt">&lt;meta</span> <span class="na">property=</span><span class="s">"og:url"</span> <span class="na">content=</span><span class="s">"</span><span class="cp">&lt;?=</span><span class="nx">SITE_SERVER_PROTOCOL</span> <span class="o">.</span> <span class="nx">SITE_SERVER_NAME</span> <span class="o">.</span> <span class="nv">$curPage</span><span class="cp">?&gt;</span><span class="s">"</span><span class="nt">&gt;</span><br data-jekyll-commonmark-ghpages="" /><span class="nt">&lt;meta</span> <span class="na">property=</span><span class="s">"og:type"</span> <span class="na">content=</span><span class="s">"website"</span><span class="nt">&gt;</span><br data-jekyll-commonmark-ghpages="" /><span class="nt">&lt;meta</span> <span class="na">property=</span><span class="s">"og:title"</span> <span class="na">content=</span><span class="s">"</span><span class="cp">&lt;?</span><span class="nv">$APPLICATION</span><span class="o">-&gt;</span><span class="na">ShowProperty</span><span class="p">(</span><span class="s2">"title"</span><span class="p">)</span><span class="cp">?&gt;</span><span class="s">"</span><span class="nt">&gt;</span><br data-jekyll-commonmark-ghpages="" /><span class="nt">&lt;meta</span> <span class="na">property=</span><span class="s">"og:description"</span> <span class="na">content=</span><span class="s">"</span><span class="cp">&lt;?=</span><span class="nv">$APPLICATION</span><span class="o">-&gt;</span><span class="na">ShowProperty</span><span class="p">(</span><span class="s2">"description"</span><span class="p">)</span><span class="cp">?&gt;</span><span class="s">"</span><span class="nt">&gt;</span><br data-jekyll-commonmark-ghpages="" /><span class="nt">&lt;meta</span> <span class="na">property=</span><span class="s">"og:image"</span> <span class="na">content=</span><span class="s">"</span><span class="cp">&lt;?=</span><span class="nv">$APPLICATION</span><span class="o">-&gt;</span><span class="na">ShowProperty</span><span class="p">(</span><span class="s2">"og:image"</span><span class="p">)</span><span class="cp">?&gt;</span><span class="s">"</span><span class="nt">&gt;</span></code></pre></figure><p>Для вывода og:url воспользовались конструкцией, которая формирует полную ссылку на текущую страницу:<figure class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?=</span><span class="nx">SITE_SERVER_PROTOCOL</span> <span class="o">.</span> <span class="nx">SITE_SERVER_NAME</span> <span class="o">.</span> <span class="nv">$curPage</span><span class="cp">?&gt;</span></code></pre></figure><p>Параметр og:type в нашем случае принимает значение website.<p>Для вывода заголовка og:title и описания og:description воспользовались функцией 1С-Битрикс $APPLICATION-&gt;ShowProperty, которая является отложенной функцией и позволяет выводить информацию выше того места, где она была задана. Т.е. при формировании страницы из блока новости, в заголовок будет попадать информация из title и description текущей новости, а не стандартные параметры раздела.<p>Остается последний очень важный параметр — превью нашей записи. Изображение можно создать из детальной картинки записи, обрезав его под размер 1200х630 px и передать в параметр og:image. Но при включенном автокешировании данные перестанут передаваться, когда страница будет загружена из кеша и вся конструкция развалится. Для этого необходимо сделать следующее:<p>1) В папке с шаблоном детальной страницы создать файл <strong>result_modifier.php</strong> и в нем добавить параметры, которые будут передаваться после кеширования:<figure class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?</span><br data-jekyll-commonmark-ghpages="" /><span class="c1">// Создаем изображение для превью соц.сетей<br data-jekyll-commonmark-ghpages="" /></span><span class="nv">$image_social</span> <span class="o">=</span> <span class="nx">CFile</span><span class="o">::</span><span class="na">ResizeImageGet</span><span class="p">(</span><span class="nv">$arResult</span><span class="p">[</span><span class="s2">"DETAIL_PICTURE"</span><span class="p">],</span> <span class="k">array</span><span class="p">(</span><span class="s1">'width'</span><span class="o">=&gt;</span><span class="s1">'1200'</span><span class="p">,</span> <span class="s1">'height'</span><span class="o">=&gt;</span><span class="s1">'630'</span><span class="p">),</span> <span class="nx">BX_RESIZE_IMAGE_EXACT</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span><br data-jekyll-commonmark-ghpages="" /><span class="nv">$arResult</span><span class="p">[</span><span class="s2">"DETAIL_PICTURE"</span><span class="p">][</span><span class="s2">"SOCIAL"</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$image_social</span><span class="p">[</span><span class="s2">"src"</span><span class="p">];</span><br data-jekyll-commonmark-ghpages="" /><br data-jekyll-commonmark-ghpages="" /><span class="c1">// Передаем данные в результат после кеширования<br data-jekyll-commonmark-ghpages="" /></span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">__component</span><span class="o">-&gt;</span><span class="na">SetResultCacheKeys</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><br data-jekyll-commonmark-ghpages="" />	<span class="s2">"DETAIL_PICTURE"</span><br data-jekyll-commonmark-ghpages="" /><span class="p">));</span><br data-jekyll-commonmark-ghpages="" /><span class="cp">?&gt;</span></code></pre></figure><p>2) Далее добавляем файл component_epilog.php, который формируется уже после вывода информации из кеша и в нем добавляем код, задающий изображение:<figure class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?</span><br data-jekyll-commonmark-ghpages="" /><span class="nv">$APPLICATION</span><span class="o">-&gt;</span><span class="na">SetPageProperty</span><span class="p">(</span><span class="s2">"og:image"</span><span class="p">,</span> <span class="nx">SITE_SERVER_PROTOCOL</span> <span class="o">.</span> <span class="nx">SITE_SERVER_NAME</span> <span class="o">.</span> <span class="nv">$arResult</span><span class="p">[</span><span class="s1">'DETAIL_PICTURE'</span><span class="p">][</span><span class="s1">'SOCIAL'</span><span class="p">]);</span><br data-jekyll-commonmark-ghpages="" /><span class="cp">?&gt;</span></code></pre></figure><p>Вот таким способом мы можем добавить информацию о разметке Open Graph в шапку шаблона 1С-Битрикс.<p>Поделимся еще полезной ссылкой, которая позволяет проверить вид ссылок, которые будут публиковаться в Facebook и устранить ошибки: <a href="https://developers.facebook.com/tools/debug/">https://developers.facebook.com/tools/debug/</a><p align="right"><small><em>Источник: https://keengo.ru/blog/1s-bitrix/open-graph-razmetka-v-1s-bitriks/</em></small><div class="post-links"> <a class="link-to-post" href="/blog/black-website-promotion-how-not-to-do/"> <span class="link-to-post__next">&#10535; &nbsp;Next post</span> <span class="link-to-post__title">Черные методы продвижения сайтов. Что не стоит делать, если хотите вывести сайт в ТОП</span> </a> <a class="link-to-post" href="/blog/parallel-execution-of-ssh-commands-on-servers/"> <span class="link-to-post__prev">&#10535; &nbsp;Previous post</span> <span class="link-to-post__title">Параллельное выполнение ssh команд на серверах</span> </a></div></div></article></main><footer class="blog-footer content-wrapper"><p>&copy; <span class="full-year"></span> denisnovikov.github.io</footer><script src="/assets/js/scripts.js"></script>  <script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function () { try { w.yaCounter45975960 = new Ya.Metrika({ id: 45975960, clickmap: true, trackLinks: true, accurateTrackBounce: true, webvisor: true }); } catch (e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks"); </script> <noscript><div> <img src="https://mc.yandex.ru/watch/45975960" style="position:absolute; left:-9999px;" alt="" /></div></noscript>  <!--Openstat--> <span id="openstat1"></span> <script type="text/javascript"> var openstat = { counter: 1, next: openstat }; (function(d, t, p) { var j = d.createElement(t); j.async = true; j.type = "text/javascript"; j.src = ("https:" == p ? "https:" : "http:") + "//openstat.net/cnt.js"; var s = d.getElementsByTagName(t)[0]; s.parentNode.insertBefore(j, s); })(document, "script", document.location.protocol); </script> <!--/Openstat-->
